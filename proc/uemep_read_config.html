<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="Air quality dispersion model for high resolution downscaling of EMEP-MSC-W">
    <meta name="author" content="" >
    <link rel="icon" href="../favicon.png">

    <title>uEMEP_read_config &ndash; Fortran Program</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
      <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">Fortran Program </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../program/uemep_v6.html">Program</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>uEMEP_read_config
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 3.8% of total for procedures.">746 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/uEMEP_read_config.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/uemep_read_config.f90.html'>uEMEP_read_config.f90</a></li>
                <li class="breadcrumb-item"><a href='../module/read_config.html'>read_config</a></li>
            <li class="breadcrumb-item active" aria-current="page">uEMEP_read_config</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-bs-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/uemep_read_config.html#src">uEMEP_read_config</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public  subroutine uEMEP_read_config()  
</h2>
    



    <h3>Arguments</h3>
    <em>None</em>
    <br>
    <br>


    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">    </span><span class="k">subroutine </span><span class="n">uEMEP_read_config</span>

<span class="w">        </span><span class="k">implicit none</span>

<span class="k">        </span><span class="kt">integer </span><span class="n">i</span>
<span class="w">        </span><span class="kt">character</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span><span class="w"> </span><span class="n">pathfilename_log_file</span>
<span class="w">        </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">exists</span>
<span class="w">        </span><span class="kt">integer </span><span class="n">a</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="w">        </span><span class="kt">character</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span><span class="w"> </span><span class="n">format_temp</span>

<span class="w">        </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">unit_in</span><span class="o">=</span><span class="mi">30</span>
<span class="w">        </span><span class="kt">integer </span><span class="n">i_config</span><span class="p">,</span><span class="n">i_source</span><span class="p">,</span><span class="n">i_landuse</span>
<span class="w">        </span><span class="kt">double precision </span><span class="n">datenum_temp</span>
<span class="w">        </span><span class="kt">character</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span><span class="w"> </span><span class="n">yesterday_date_str</span>
<span class="w">        </span><span class="kt">character</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span><span class="w"> </span><span class="n">a_str</span><span class="p">,</span><span class="n">b_str</span>
<span class="w">        </span><span class="kt">character</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span><span class="w"> </span><span class="n">temp_str</span>

<span class="c">!==========================================================================</span>
<span class="c">!   uEMEP model setup</span>
<span class="c">!==========================================================================</span>

<span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;&#39;</span>
<span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;================================================================&#39;</span>
<span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Reading model run configuration (uEMEP_read_config)&#39;</span>
<span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;================================================================&#39;</span>


<span class="w">        </span><span class="k">do </span><span class="n">i_config</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n_config_files</span>

<span class="w">            </span><span class="c">!Temporary hardcoding of config file name. Will be read in as command line string</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">name_config_file</span><span class="p">(</span><span class="n">i_config</span><span class="p">)).</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                </span><span class="c">!name_config_file=&#39;C:\uEMEP\Fortran\application\config\uEMEP_config_test.txt&#39;</span>
<span class="w">                </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;ERROR: No configuration file available. Stopping.&#39;</span>
<span class="w">                </span><span class="k">stop</span>
<span class="k">            endif</span>


<span class="k">            write</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Reading configuration file: &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">name_config_file</span><span class="p">(</span><span class="n">i_config</span><span class="p">))</span>

<span class="w">            </span><span class="c">!Check existence of file</span>
<span class="w">            </span><span class="k">inquire</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">name_config_file</span><span class="p">(</span><span class="n">i_config</span><span class="p">)),</span><span class="n">exist</span><span class="o">=</span><span class="n">exists</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">exists</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="s1">&#39;ERROR: Configuration file &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">name_config_file</span><span class="p">(</span><span class="n">i_config</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; does not exist.&#39;</span>
<span class="w">                </span><span class="k">stop</span>
<span class="k">            endif</span>

<span class="w">            </span><span class="c">!Open the config file for reading</span>
<span class="w">            </span><span class="k">open</span><span class="p">(</span><span class="n">unit_in</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="n">name_config_file</span><span class="p">(</span><span class="n">i_config</span><span class="p">),</span><span class="nb">access</span><span class="o">=</span><span class="s1">&#39;sequential&#39;</span><span class="p">,</span><span class="n">status</span><span class="o">=</span><span class="s1">&#39;old&#39;</span><span class="p">,</span><span class="n">readonly</span><span class="p">)</span>

<span class="w">            </span><span class="c">!First read log file name and open it</span>
<span class="w">            </span><span class="n">filename_log_file</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_log_file&#39;</span><span class="p">,</span><span class="n">filename_log_file</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">pathname_log_file</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_log_file&#39;</span><span class="p">,</span><span class="n">pathname_log_file</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="c">!Open log file when reading the first configuration file</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i_config</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                if</span><span class="w"> </span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">filename_log_file</span><span class="p">)).</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">unit_logfile</span><span class="o">=</span><span class="mi">10</span>
<span class="w">                    </span><span class="c">!Check existence of path</span>
<span class="w">                    </span><span class="k">inquire</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">pathname_log_file</span><span class="p">),</span><span class="n">exist</span><span class="o">=</span><span class="n">exists</span><span class="p">)</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">exists</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        write</span><span class="p">(</span><span class="n">unit_logfile</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="s1">&#39;ERROR: Log file directory path &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">pathname_log_file</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; does not exist.&#39;</span>
<span class="w">                        </span><span class="k">stop</span>
<span class="k">                    endif</span>
<span class="w">                    </span><span class="c">!Write to screen if writing to log file</span>
<span class="w">                    </span><span class="n">pathfilename_log_file</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">pathname_log_file</span><span class="p">)</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">filename_log_file</span><span class="p">)</span>
<span class="w">                    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(A,A)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Writing to log file: &#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">pathfilename_log_file</span><span class="p">)</span>
<span class="w">                    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;================================================================&#39;</span>
<span class="w">                    </span><span class="k">open</span><span class="p">(</span><span class="n">unit_logfile</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">pathfilename_log_file</span><span class="p">),</span><span class="nb">access</span><span class="o">=</span><span class="s1">&#39;sequential&#39;</span><span class="p">,</span><span class="n">form</span><span class="o">=</span><span class="s1">&#39;formatted&#39;</span><span class="p">,</span><span class="n">status</span><span class="o">=</span><span class="s1">&#39;unknown&#39;</span><span class="p">)</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">unit_logfile</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        write</span><span class="p">(</span><span class="n">unit_logfile</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;------------------------------------------------------------------------&#39;</span>
<span class="w">                        </span><span class="k">write</span><span class="p">(</span><span class="n">unit_logfile</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Starting programm &#39;</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">model_version_str</span><span class="p">)</span>
<span class="w">                        </span><span class="k">write</span><span class="p">(</span><span class="n">unit_logfile</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;------------------------------------------------------------------------&#39;</span>
<span class="w">                    </span><span class="k">endif</span>
<span class="k">                else</span>
<span class="k">                    </span><span class="n">unit_logfile</span><span class="o">=</span><span class="mi">0</span>
<span class="w">                </span><span class="k">endif</span>

<span class="k">            endif</span>

<span class="k">            </span><span class="n">file_tag</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;file_tag&#39;</span><span class="p">,</span><span class="n">file_tag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">replacement_date_str</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;replacement_date_str&#39;</span><span class="p">,</span><span class="n">replacement_date_str</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">replacement_yesterday_date_str</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;replacement_yesterday_date_str&#39;</span><span class="p">,</span><span class="n">replacement_yesterday_date_str</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">replacement_hour_str</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;replacement_hour_str&#39;</span><span class="p">,</span><span class="n">replacement_hour_str</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">NORTRIP_replacement_hour_str</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;NORTRIP_replacement_hour_str&#39;</span><span class="p">,</span><span class="n">NORTRIP_replacement_hour_str</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">input_comp_name</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;input_comp_name&#39;</span><span class="p">,</span><span class="n">input_comp_name</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">hourly_calculations</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;hourly_calculations&#39;</span><span class="p">,</span><span class="n">hourly_calculations</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">annual_calculations</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;annual_calculations&#39;</span><span class="p">,</span><span class="n">annual_calculations</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="c">!Not implemented</span>
<span class="w">            </span><span class="c">!start_month_in_annual_calculations=read_name_integer(&#39;start_month_in_annual_calculations&#39;,start_month_in_annual_calculations,unit_in,unit_logfile)</span>
<span class="w">            </span><span class="c">!end_month_in_annual_calculations=read_name_integer(&#39;end_month_in_annual_calculations&#39;,end_month_in_annual_calculations,unit_in,unit_logfile)</span>

<span class="w">            </span><span class="n">start_time_nc_index</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;start_time_nc_index&#39;</span><span class="p">,</span><span class="n">start_time_nc_index</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">end_time_nc_index</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;end_time_nc_index&#39;</span><span class="p">,</span><span class="n">end_time_nc_index</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">start_time_meteo_nc_index</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;start_time_meteo_nc_index&#39;</span><span class="p">,</span><span class="n">start_time_meteo_nc_index</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">end_time_meteo_nc_index</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;end_time_meteo_nc_index&#39;</span><span class="p">,</span><span class="n">end_time_meteo_nc_index</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">use_single_time_loop_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_single_time_loop_flag&#39;</span><span class="p">,</span><span class="n">use_single_time_loop_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">reduce_EMEP_region_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;reduce_EMEP_region_flag&#39;</span><span class="p">,</span><span class="n">reduce_EMEP_region_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_multiple_receptor_grids_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_multiple_receptor_grids_flag&#39;</span><span class="p">,</span><span class="n">use_multiple_receptor_grids_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_receptor_region</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;use_receptor_region&#39;</span><span class="p">,</span><span class="n">use_receptor_region</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">reduce_roadlink_region_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;reduce_roadlink_region_flag&#39;</span><span class="p">,</span><span class="n">reduce_roadlink_region_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="c">!Choose which sources to calculate</span>
<span class="w">            </span><span class="c">!calculate_source(:)=read_name_logical(&#39;calculate_source(:)&#39;,calculate_source(allsource_index),unit_in,unit_logfile)</span>
<span class="w">            </span><span class="n">calculate_source</span><span class="p">(</span><span class="n">traffic_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_source(traffic_index)&#39;</span><span class="p">,</span><span class="n">calculate_source</span><span class="p">(</span><span class="n">traffic_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">calculate_source</span><span class="p">(</span><span class="n">shipping_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_source(shipping_index)&#39;</span><span class="p">,</span><span class="n">calculate_source</span><span class="p">(</span><span class="n">shipping_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">calculate_source</span><span class="p">(</span><span class="n">heating_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_source(heating_index)&#39;</span><span class="p">,</span><span class="n">calculate_source</span><span class="p">(</span><span class="n">heating_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">calculate_source</span><span class="p">(</span><span class="n">agriculture_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_source(agriculture_index)&#39;</span><span class="p">,</span><span class="n">calculate_source</span><span class="p">(</span><span class="n">agriculture_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">calculate_source</span><span class="p">(</span><span class="n">industry_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_source(industry_index)&#39;</span><span class="p">,</span><span class="n">calculate_source</span><span class="p">(</span><span class="n">industry_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="c">!Additional GNFR sources</span>
<span class="w">            </span><span class="n">calculate_source</span><span class="p">(</span><span class="n">publicpower_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_source(publicpower_index)&#39;</span><span class="p">,</span><span class="n">calculate_source</span><span class="p">(</span><span class="n">publicpower_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">calculate_source</span><span class="p">(</span><span class="n">fugitive_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_source(fugitive_index)&#39;</span><span class="p">,</span><span class="n">calculate_source</span><span class="p">(</span><span class="n">fugitive_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">calculate_source</span><span class="p">(</span><span class="n">solvents_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_source(solvents_index)&#39;</span><span class="p">,</span><span class="n">calculate_source</span><span class="p">(</span><span class="n">solvents_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">calculate_source</span><span class="p">(</span><span class="n">aviation_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_source(aviation_index)&#39;</span><span class="p">,</span><span class="n">calculate_source</span><span class="p">(</span><span class="n">aviation_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">calculate_source</span><span class="p">(</span><span class="n">offroad_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_source(offroad_index)&#39;</span><span class="p">,</span><span class="n">calculate_source</span><span class="p">(</span><span class="n">offroad_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">calculate_source</span><span class="p">(</span><span class="n">waste_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_source(waste_index)&#39;</span><span class="p">,</span><span class="n">calculate_source</span><span class="p">(</span><span class="n">waste_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">calculate_source</span><span class="p">(</span><span class="n">livestock_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_source(livestock_index)&#39;</span><span class="p">,</span><span class="n">calculate_source</span><span class="p">(</span><span class="n">livestock_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">calculate_source</span><span class="p">(</span><span class="n">other_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_source(other_index)&#39;</span><span class="p">,</span><span class="n">calculate_source</span><span class="p">(</span><span class="n">other_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="c">!Choose which EMEP sources to include/calculate. Will not be downscaled but will included as gridded source contributions</span>
<span class="w">            </span><span class="c">!calculate_source(:)=read_name_logical(&#39;calculate_source(:)&#39;,calculate_source(allsource_index),unit_in,unit_logfile)</span>
<span class="w">            </span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">traffic_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_EMEP_source(traffic_index)&#39;</span><span class="p">,</span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">traffic_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">shipping_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_EMEP_source(shipping_index)&#39;</span><span class="p">,</span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">shipping_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">heating_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_EMEP_source(heating_index)&#39;</span><span class="p">,</span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">heating_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">agriculture_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_EMEP_source(agriculture_index)&#39;</span><span class="p">,</span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">agriculture_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">industry_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_EMEP_source(industry_index)&#39;</span><span class="p">,</span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">industry_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="c">!Additional GNFR13 sources</span>
<span class="w">            </span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">publicpower_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_EMEP_source(publicpower_index)&#39;</span><span class="p">,</span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">publicpower_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">fugitive_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_EMEP_source(fugitive_index)&#39;</span><span class="p">,</span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">fugitive_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">solvents_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_EMEP_source(solvents_index)&#39;</span><span class="p">,</span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">solvents_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">aviation_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_EMEP_source(aviation_index)&#39;</span><span class="p">,</span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">aviation_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">offroad_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_EMEP_source(offroad_index)&#39;</span><span class="p">,</span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">offroad_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">waste_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_EMEP_source(waste_index)&#39;</span><span class="p">,</span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">waste_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">livestock_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_EMEP_source(livestock_index)&#39;</span><span class="p">,</span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">livestock_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">other_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_EMEP_source(other_index)&#39;</span><span class="p">,</span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">other_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="c">!GNFR19 sources. Note nc_index not in the input</span>
<span class="w">            </span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">traffic_gasoline_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_EMEP_source(traffic_gasoline_index)&#39;</span><span class="p">,</span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">traffic_gasoline_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">traffic_diesel_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_EMEP_source(traffic_diesel_index)&#39;</span><span class="p">,</span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">traffic_diesel_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">traffic_gas_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_EMEP_source(traffic_gas_index)&#39;</span><span class="p">,</span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">traffic_gas_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">traffic_nonexhaust_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_EMEP_source(traffic_nonexhaust_index)&#39;</span><span class="p">,</span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">traffic_nonexhaust_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">publicpower_point_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_EMEP_source(publicpower_point_index)&#39;</span><span class="p">,</span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">publicpower_point_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">publicpower_area_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_EMEP_source(publicpower_area_index)&#39;</span><span class="p">,</span><span class="n">calculate_EMEP_source</span><span class="p">(</span><span class="n">publicpower_area_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>


<span class="w">            </span><span class="c">!do i_source=1,n_source_index</span>
<span class="w">            </span><span class="c">!    if (calculate_source(i_source)) calculate_source(allsource_index)=.true.</span>
<span class="w">            </span><span class="c">!enddo</span>

<span class="w">            </span><span class="c">!For aggregating proxy emission data to EMEP grids in ascii test routines that no longer exist. Default is false</span>
<span class="w">            </span><span class="n">make_EMEP_grid_emission_data</span><span class="p">(</span><span class="n">traffic_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;make_EMEP_grid_emission_data(traffic_index)&#39;</span><span class="p">,</span><span class="n">make_EMEP_grid_emission_data</span><span class="p">(</span><span class="n">traffic_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">make_EMEP_grid_emission_data</span><span class="p">(</span><span class="n">shipping_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;make_EMEP_grid_emission_data(shipping_index)&#39;</span><span class="p">,</span><span class="n">make_EMEP_grid_emission_data</span><span class="p">(</span><span class="n">shipping_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">make_EMEP_grid_emission_data</span><span class="p">(</span><span class="n">heating_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;make_EMEP_grid_emission_data(heating_index)&#39;</span><span class="p">,</span><span class="n">make_EMEP_grid_emission_data</span><span class="p">(</span><span class="n">heating_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">make_EMEP_grid_emission_data</span><span class="p">(</span><span class="n">agriculture_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;make_EMEP_grid_emission_data(agriculture_index)&#39;</span><span class="p">,</span><span class="n">make_EMEP_grid_emission_data</span><span class="p">(</span><span class="n">agriculture_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">make_EMEP_grid_emission_data</span><span class="p">(</span><span class="n">industry_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;make_EMEP_grid_emission_data(industry_index)&#39;</span><span class="p">,</span><span class="n">make_EMEP_grid_emission_data</span><span class="p">(</span><span class="n">industry_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="c">!Additional GNFR sources</span>
<span class="w">            </span><span class="n">make_EMEP_grid_emission_data</span><span class="p">(</span><span class="n">publicpower_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;make_EMEP_grid_emission_data(publicpower_index)&#39;</span><span class="p">,</span><span class="n">make_EMEP_grid_emission_data</span><span class="p">(</span><span class="n">publicpower_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">make_EMEP_grid_emission_data</span><span class="p">(</span><span class="n">fugitive_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;make_EMEP_grid_emission_data(fugitive_index)&#39;</span><span class="p">,</span><span class="n">make_EMEP_grid_emission_data</span><span class="p">(</span><span class="n">fugitive_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">make_EMEP_grid_emission_data</span><span class="p">(</span><span class="n">solvents_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;make_EMEP_grid_emission_data(solvents_index)&#39;</span><span class="p">,</span><span class="n">make_EMEP_grid_emission_data</span><span class="p">(</span><span class="n">solvents_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">make_EMEP_grid_emission_data</span><span class="p">(</span><span class="n">aviation_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;make_EMEP_grid_emission_data(aviation_index)&#39;</span><span class="p">,</span><span class="n">make_EMEP_grid_emission_data</span><span class="p">(</span><span class="n">aviation_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">make_EMEP_grid_emission_data</span><span class="p">(</span><span class="n">offroad_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;make_EMEP_grid_emission_data(offroad_index)&#39;</span><span class="p">,</span><span class="n">make_EMEP_grid_emission_data</span><span class="p">(</span><span class="n">offroad_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">make_EMEP_grid_emission_data</span><span class="p">(</span><span class="n">waste_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;make_EMEP_grid_emission_data(waste_index)&#39;</span><span class="p">,</span><span class="n">make_EMEP_grid_emission_data</span><span class="p">(</span><span class="n">waste_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">make_EMEP_grid_emission_data</span><span class="p">(</span><span class="n">livestock_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;make_EMEP_grid_emission_data(livestock_index)&#39;</span><span class="p">,</span><span class="n">make_EMEP_grid_emission_data</span><span class="p">(</span><span class="n">livestock_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">make_EMEP_grid_emission_data</span><span class="p">(</span><span class="n">other_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;make_EMEP_grid_emission_data(other_index)&#39;</span><span class="p">,</span><span class="n">make_EMEP_grid_emission_data</span><span class="p">(</span><span class="n">other_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="k">do </span><span class="n">i_source</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n_source_index</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">make_EMEP_grid_emission_data</span><span class="p">(</span><span class="n">i_source</span><span class="p">))</span><span class="w"> </span><span class="n">make_EMEP_grid_emission_data</span><span class="p">(</span><span class="n">allsource_index</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">            </span><span class="k">enddo</span>

<span class="w">            </span><span class="c">!For scaling EMEP concentrations with EMEP/local emission ratio. for testing purposes only. Default is false</span>
<span class="w">            </span><span class="n">replace_EMEP_local_with_subgrid_local</span><span class="p">(</span><span class="n">traffic_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;replace_EMEP_local_with_subgrid_local(traffic_index)&#39;</span><span class="p">,</span><span class="n">replace_EMEP_local_with_subgrid_local</span><span class="p">(</span><span class="n">traffic_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">replace_EMEP_local_with_subgrid_local</span><span class="p">(</span><span class="n">shipping_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;replace_EMEP_local_with_subgrid_local(shipping_index)&#39;</span><span class="p">,</span><span class="n">replace_EMEP_local_with_subgrid_local</span><span class="p">(</span><span class="n">shipping_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">replace_EMEP_local_with_subgrid_local</span><span class="p">(</span><span class="n">heating_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;replace_EMEP_local_with_subgrid_local(heating_index)&#39;</span><span class="p">,</span><span class="n">replace_EMEP_local_with_subgrid_local</span><span class="p">(</span><span class="n">heating_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">replace_EMEP_local_with_subgrid_local</span><span class="p">(</span><span class="n">agriculture_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;replace_EMEP_local_with_subgrid_local(agriculture_index)&#39;</span><span class="p">,</span><span class="n">replace_EMEP_local_with_subgrid_local</span><span class="p">(</span><span class="n">agriculture_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">replace_EMEP_local_with_subgrid_local</span><span class="p">(</span><span class="n">industry_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;replace_EMEP_local_with_subgrid_local(industry_index)&#39;</span><span class="p">,</span><span class="n">replace_EMEP_local_with_subgrid_local</span><span class="p">(</span><span class="n">industry_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">projection_type</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;projection_type&#39;</span><span class="p">,</span><span class="n">projection_type</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">EMEP_projection_type</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;EMEP_projection_type&#39;</span><span class="p">,</span><span class="n">EMEP_projection_type</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">utm_zone</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;utm_zone&#39;</span><span class="p">,</span><span class="n">utm_zone</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="c">!Present UTM central lon position if not overridden by input</span>
<span class="w">            </span><span class="n">utm_lon0</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">utm_zone</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="o">-</span><span class="mi">180</span><span class="o">-</span><span class="mi">3</span>
<span class="w">            </span><span class="n">utm_lon0</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;utm_lon0&#39;</span><span class="p">,</span><span class="n">utm_lon0</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">ltm_lon0</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;ltm_lon0&#39;</span><span class="p">,</span><span class="n">ltm_lon0</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="c">!Read the projection attributes for uEMEP if they are available</span>
<span class="w">            </span><span class="n">projection_attributes</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_double</span><span class="p">(</span><span class="s1">&#39;projection_attributes(1)&#39;</span><span class="p">,</span><span class="n">projection_attributes</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">projection_attributes</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_double</span><span class="p">(</span><span class="s1">&#39;projection_attributes(2)&#39;</span><span class="p">,</span><span class="n">projection_attributes</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">projection_attributes</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_double</span><span class="p">(</span><span class="s1">&#39;projection_attributes(3)&#39;</span><span class="p">,</span><span class="n">projection_attributes</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">projection_attributes</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_double</span><span class="p">(</span><span class="s1">&#39;projection_attributes(4)&#39;</span><span class="p">,</span><span class="n">projection_attributes</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">projection_attributes</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_double</span><span class="p">(</span><span class="s1">&#39;projection_attributes(5)&#39;</span><span class="p">,</span><span class="n">projection_attributes</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">projection_attributes</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_double</span><span class="p">(</span><span class="s1">&#39;projection_attributes(6)&#39;</span><span class="p">,</span><span class="n">projection_attributes</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">projection_attributes</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_double</span><span class="p">(</span><span class="s1">&#39;projection_attributes(7)&#39;</span><span class="p">,</span><span class="n">projection_attributes</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="c">!Read the projection attributes for EMEP if they are available</span>
<span class="w">            </span><span class="c">!THese will be reset if EMEP data is read in</span>
<span class="w">            </span><span class="n">EMEP_projection_attributes</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_double</span><span class="p">(</span><span class="s1">&#39;EMEP_projection_attributes(1)&#39;</span><span class="p">,</span><span class="n">EMEP_projection_attributes</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">EMEP_projection_attributes</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_double</span><span class="p">(</span><span class="s1">&#39;EMEP_projection_attributes(2)&#39;</span><span class="p">,</span><span class="n">EMEP_projection_attributes</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">EMEP_projection_attributes</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_double</span><span class="p">(</span><span class="s1">&#39;EMEP_projection_attributes(3)&#39;</span><span class="p">,</span><span class="n">EMEP_projection_attributes</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">EMEP_projection_attributes</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_double</span><span class="p">(</span><span class="s1">&#39;EMEP_projection_attributes(4)&#39;</span><span class="p">,</span><span class="n">EMEP_projection_attributes</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">EMEP_projection_attributes</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_double</span><span class="p">(</span><span class="s1">&#39;EMEP_projection_attributes(5)&#39;</span><span class="p">,</span><span class="n">EMEP_projection_attributes</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">EMEP_projection_attributes</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_double</span><span class="p">(</span><span class="s1">&#39;EMEP_projection_attributes(6)&#39;</span><span class="p">,</span><span class="n">EMEP_projection_attributes</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">EMEP_projection_attributes</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_double</span><span class="p">(</span><span class="s1">&#39;EMEP_projection_attributes(7)&#39;</span><span class="p">,</span><span class="n">EMEP_projection_attributes</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">EMEP_grid_interpolation_flag</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;EMEP_grid_interpolation_flag&#39;</span><span class="p">,</span><span class="n">EMEP_grid_interpolation_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">EMEP_meteo_grid_interpolation_flag</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;EMEP_meteo_grid_interpolation_flag&#39;</span><span class="p">,</span><span class="n">EMEP_meteo_grid_interpolation_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">EMEP_emission_grid_interpolation_flag</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;EMEP_emission_grid_interpolation_flag&#39;</span><span class="p">,</span><span class="n">EMEP_emission_grid_interpolation_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">subgrid_emission_distribution_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;subgrid_emission_distribution_flag&#39;</span><span class="p">,</span><span class="n">subgrid_emission_distribution_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="c">!Not used</span>
<span class="w">            </span><span class="n">EMEP_grid_interpolation_simple_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;EMEP_grid_interpolation_simple_flag&#39;</span><span class="p">,</span><span class="n">EMEP_grid_interpolation_simple_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">EMEP_grid_interpolation_size</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;EMEP_grid_interpolation_size&#39;</span><span class="p">,</span><span class="n">EMEP_grid_interpolation_size</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">EMEP_additional_grid_interpolation_size</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;EMEP_additional_grid_interpolation_size&#39;</span><span class="p">,</span><span class="n">EMEP_additional_grid_interpolation_size</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_downwind_position_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_downwind_position_flag&#39;</span><span class="p">,</span><span class="n">use_downwind_position_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">local_subgrid_method_flag</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;local_subgrid_method_flag&#39;</span><span class="p">,</span><span class="n">local_subgrid_method_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">stability_scheme_flag</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;stability_scheme_flag&#39;</span><span class="p">,</span><span class="n">stability_scheme_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">average_zc_h_in_Kz_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;average_zc_h_in_Kz_flag&#39;</span><span class="p">,</span><span class="n">average_zc_h_in_Kz_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">wind_level_flag</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;wind_level_flag&#39;</span><span class="p">,</span><span class="n">wind_level_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">wind_level_integral_flag</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;wind_level_integral_flag&#39;</span><span class="p">,</span><span class="n">wind_level_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span><span class="w"> </span><span class="c">!Default is wind_level_flag</span>
<span class="w">            </span><span class="n">no2_chemistry_scheme_flag</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;no2_chemistry_scheme_flag&#39;</span><span class="p">,</span><span class="n">no2_chemistry_scheme_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">no2_background_chemistry_scheme_flag</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;no2_background_chemistry_scheme_flag&#39;</span><span class="p">,</span><span class="n">no2_background_chemistry_scheme_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">use_emission_positions_for_auto_subgrid_flag</span><span class="p">(</span><span class="n">traffic_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_emission_positions_for_auto_subgrid_flag(traffic_index)&#39;</span><span class="p">,</span><span class="n">use_emission_positions_for_auto_subgrid_flag</span><span class="p">(</span><span class="n">traffic_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_emission_positions_for_auto_subgrid_flag</span><span class="p">(</span><span class="n">shipping_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_emission_positions_for_auto_subgrid_flag(shipping_index)&#39;</span><span class="p">,</span><span class="n">use_emission_positions_for_auto_subgrid_flag</span><span class="p">(</span><span class="n">shipping_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_emission_positions_for_auto_subgrid_flag</span><span class="p">(</span><span class="n">heating_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_emission_positions_for_auto_subgrid_flag(heating_index)&#39;</span><span class="p">,</span><span class="n">use_emission_positions_for_auto_subgrid_flag</span><span class="p">(</span><span class="n">heating_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_emission_positions_for_auto_subgrid_flag</span><span class="p">(</span><span class="n">agriculture_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_emission_positions_for_auto_subgrid_flag(agriculture_index)&#39;</span><span class="p">,</span><span class="n">use_emission_positions_for_auto_subgrid_flag</span><span class="p">(</span><span class="n">agriculture_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_emission_positions_for_auto_subgrid_flag</span><span class="p">(</span><span class="n">industry_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_emission_positions_for_auto_subgrid_flag(industry_index)&#39;</span><span class="p">,</span><span class="n">use_emission_positions_for_auto_subgrid_flag</span><span class="p">(</span><span class="n">industry_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="c">!Set all source index to true if any of the sources are to be auto gridded. allsource_index defines if the routine is called or not</span>
<span class="w">            </span><span class="k">do </span><span class="n">i_source</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n_source_index</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">use_emission_positions_for_auto_subgrid_flag</span><span class="p">(</span><span class="n">i_source</span><span class="p">).</span><span class="nb">and</span><span class="p">.</span><span class="n">i_source</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">allsource_index</span><span class="p">)</span><span class="w"> </span><span class="n">use_emission_positions_for_auto_subgrid_flag</span><span class="p">(</span><span class="n">allsource_index</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">            </span><span class="k">enddo</span>
<span class="w">            </span><span class="c">!do i_source=1,n_source_index</span>
<span class="w">            </span><span class="c">!write(*,*) &#39;Using auto subgrid for source &#39;,trim(source_file_str(i_source)),use_emission_positions_for_auto_subgrid_flag(i_source)</span>
<span class="w">            </span><span class="c">!enddo</span>

<span class="w">            </span><span class="n">use_receptor_positions_for_auto_subgrid_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_receptor_positions_for_auto_subgrid_flag&#39;</span><span class="p">,</span><span class="n">use_receptor_positions_for_auto_subgrid_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_population_positions_for_auto_subgrid_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_population_positions_for_auto_subgrid_flag&#39;</span><span class="p">,</span><span class="n">use_population_positions_for_auto_subgrid_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">interpolate_subgrids_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;interpolate_subgrids_flag&#39;</span><span class="p">,</span><span class="n">interpolate_subgrids_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="c">!use_trajectory_flag(:)=read_name_logical(&#39;use_trajectory_flag&#39;,use_trajectory_flag(allsource_index),unit_in,unit_logfile)</span>
<span class="w">            </span><span class="n">use_trajectory_flag</span><span class="p">(</span><span class="n">shipping_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_trajectory_flag(shipping_index)&#39;</span><span class="p">,</span><span class="n">use_trajectory_flag</span><span class="p">(</span><span class="n">shipping_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_trajectory_flag</span><span class="p">(</span><span class="n">traffic_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_trajectory_flag(traffic_index)&#39;</span><span class="p">,</span><span class="n">use_trajectory_flag</span><span class="p">(</span><span class="n">traffic_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_trajectory_flag</span><span class="p">(</span><span class="n">heating_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_trajectory_flag(heating_index)&#39;</span><span class="p">,</span><span class="n">use_trajectory_flag</span><span class="p">(</span><span class="n">heating_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_trajectory_flag</span><span class="p">(</span><span class="n">agriculture_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_trajectory_flag(agriculture_index)&#39;</span><span class="p">,</span><span class="n">use_trajectory_flag</span><span class="p">(</span><span class="n">agriculture_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_trajectory_flag</span><span class="p">(</span><span class="n">industry_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_trajectory_flag(industry_index)&#39;</span><span class="p">,</span><span class="n">use_trajectory_flag</span><span class="p">(</span><span class="n">industry_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="c">!Additional GNFR sources</span>
<span class="w">            </span><span class="n">use_trajectory_flag</span><span class="p">(</span><span class="n">publicpower_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_trajectory_flag(publicpower_index)&#39;</span><span class="p">,</span><span class="n">use_trajectory_flag</span><span class="p">(</span><span class="n">publicpower_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_trajectory_flag</span><span class="p">(</span><span class="n">fugitive_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_trajectory_flag(fugitive_index)&#39;</span><span class="p">,</span><span class="n">use_trajectory_flag</span><span class="p">(</span><span class="n">fugitive_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_trajectory_flag</span><span class="p">(</span><span class="n">solvents_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_trajectory_flag(solvents_index)&#39;</span><span class="p">,</span><span class="n">use_trajectory_flag</span><span class="p">(</span><span class="n">solvents_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_trajectory_flag</span><span class="p">(</span><span class="n">aviation_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_trajectory_flag(aviation_index)&#39;</span><span class="p">,</span><span class="n">use_trajectory_flag</span><span class="p">(</span><span class="n">aviation_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_trajectory_flag</span><span class="p">(</span><span class="n">offroad_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_trajectory_flag(offroad_index)&#39;</span><span class="p">,</span><span class="n">use_trajectory_flag</span><span class="p">(</span><span class="n">offroad_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_trajectory_flag</span><span class="p">(</span><span class="n">waste_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_trajectory_flag(waste_index)&#39;</span><span class="p">,</span><span class="n">use_trajectory_flag</span><span class="p">(</span><span class="n">waste_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_trajectory_flag</span><span class="p">(</span><span class="n">livestock_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_trajectory_flag(livestock_index)&#39;</span><span class="p">,</span><span class="n">use_trajectory_flag</span><span class="p">(</span><span class="n">livestock_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_trajectory_flag</span><span class="p">(</span><span class="n">other_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_trajectory_flag(other_index)&#39;</span><span class="p">,</span><span class="n">use_trajectory_flag</span><span class="p">(</span><span class="n">other_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">traj_step_scale</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;traj_step_scale&#39;</span><span class="p">,</span><span class="n">traj_step_scale</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">calculate_aggregated_shipping_emissions_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_aggregated_shipping_emissions_flag&#39;</span><span class="p">,</span><span class="n">calculate_aggregated_shipping_emissions_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_aggregated_shipping_emissions_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_aggregated_shipping_emissions_flag&#39;</span><span class="p">,</span><span class="n">use_aggregated_shipping_emissions_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">calculate_population_exposure_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_population_exposure_flag&#39;</span><span class="p">,</span><span class="n">calculate_population_exposure_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>


<span class="w">            </span><span class="c">!Grid specific parameters</span>
<span class="w">            </span><span class="n">integral_subgrid_step</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;integral_subgrid_step&#39;</span><span class="p">,</span><span class="n">integral_subgrid_step</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="c">!Specify the site grid information</span>
<span class="w">            </span><span class="n">subgrid_delta</span><span class="p">(</span><span class="n">x_dim_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;subgrid_delta(x_dim_index)&#39;</span><span class="p">,</span><span class="n">subgrid_delta</span><span class="p">(</span><span class="n">x_dim_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">subgrid_delta</span><span class="p">(</span><span class="n">y_dim_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;subgrid_delta(y_dim_index)&#39;</span><span class="p">,</span><span class="n">subgrid_delta</span><span class="p">(</span><span class="n">y_dim_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">subgrid_min</span><span class="p">(</span><span class="n">x_dim_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;subgrid_min(x_dim_index)&#39;</span><span class="p">,</span><span class="n">subgrid_min</span><span class="p">(</span><span class="n">x_dim_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">subgrid_min</span><span class="p">(</span><span class="n">y_dim_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;subgrid_min(y_dim_index)&#39;</span><span class="p">,</span><span class="n">subgrid_min</span><span class="p">(</span><span class="n">y_dim_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">subgrid_max</span><span class="p">(</span><span class="n">x_dim_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;subgrid_max(x_dim_index)&#39;</span><span class="p">,</span><span class="n">subgrid_max</span><span class="p">(</span><span class="n">x_dim_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">subgrid_max</span><span class="p">(</span><span class="n">y_dim_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;subgrid_max(y_dim_index)&#39;</span><span class="p">,</span><span class="n">subgrid_max</span><span class="p">(</span><span class="n">y_dim_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="c">!Save the read in grid data. This will be used to select EMEP region and receptor points</span>
<span class="w">            </span><span class="n">init_subgrid_delta</span><span class="p">(</span><span class="n">x_dim_index</span><span class="p">)</span><span class="o">=</span><span class="n">subgrid_delta</span><span class="p">(</span><span class="n">x_dim_index</span><span class="p">)</span>
<span class="w">            </span><span class="n">init_subgrid_delta</span><span class="p">(</span><span class="n">y_dim_index</span><span class="p">)</span><span class="o">=</span><span class="n">subgrid_delta</span><span class="p">(</span><span class="n">y_dim_index</span><span class="p">)</span>
<span class="w">            </span><span class="n">init_subgrid_min</span><span class="p">(</span><span class="n">x_dim_index</span><span class="p">)</span><span class="o">=</span><span class="n">subgrid_min</span><span class="p">(</span><span class="n">x_dim_index</span><span class="p">)</span>
<span class="w">            </span><span class="n">init_subgrid_min</span><span class="p">(</span><span class="n">y_dim_index</span><span class="p">)</span><span class="o">=</span><span class="n">subgrid_min</span><span class="p">(</span><span class="n">y_dim_index</span><span class="p">)</span>
<span class="w">            </span><span class="n">init_subgrid_max</span><span class="p">(</span><span class="n">x_dim_index</span><span class="p">)</span><span class="o">=</span><span class="n">subgrid_max</span><span class="p">(</span><span class="n">x_dim_index</span><span class="p">)</span>
<span class="w">            </span><span class="n">init_subgrid_max</span><span class="p">(</span><span class="n">y_dim_index</span><span class="p">)</span><span class="o">=</span><span class="n">subgrid_max</span><span class="p">(</span><span class="n">y_dim_index</span><span class="p">)</span>

<span class="w">            </span><span class="c">!These will probably be set by the input data</span>
<span class="w">            </span><span class="n">deposition_subgrid_delta</span><span class="p">(</span><span class="n">x_dim_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;deposition_subgrid_delta(x_dim_index)&#39;</span><span class="p">,</span><span class="n">deposition_subgrid_delta</span><span class="p">(</span><span class="n">x_dim_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">deposition_subgrid_delta</span><span class="p">(</span><span class="n">y_dim_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;deposition_subgrid_delta(y_dim_index)&#39;</span><span class="p">,</span><span class="n">deposition_subgrid_delta</span><span class="p">(</span><span class="n">y_dim_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">landuse_subgrid_delta</span><span class="p">(</span><span class="n">x_dim_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;landuse_subgrid_delta(x_dim_index)&#39;</span><span class="p">,</span><span class="n">landuse_subgrid_delta</span><span class="p">(</span><span class="n">x_dim_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">landuse_subgrid_delta</span><span class="p">(</span><span class="n">y_dim_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;landuse_subgrid_delta(y_dim_index)&#39;</span><span class="p">,</span><span class="n">landuse_subgrid_delta</span><span class="p">(</span><span class="n">y_dim_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="c">!Specifies the number of subsources for each source. Not used as default is 1</span>
<span class="w">            </span><span class="n">n_subsource</span><span class="p">(</span><span class="n">traffic_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;n_subsource(traffic_index)&#39;</span><span class="p">,</span><span class="n">n_subsource</span><span class="p">(</span><span class="n">traffic_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">n_subsource</span><span class="p">(</span><span class="n">shipping_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;n_subsource(shipping_index)&#39;</span><span class="p">,</span><span class="n">n_subsource</span><span class="p">(</span><span class="n">shipping_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">n_subsource</span><span class="p">(</span><span class="n">heating_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;n_subsource(heating_index)&#39;</span><span class="p">,</span><span class="n">n_subsource</span><span class="p">(</span><span class="n">heating_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">n_subsource</span><span class="p">(</span><span class="n">agriculture_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;n_subsource(agriculture_index)&#39;</span><span class="p">,</span><span class="n">n_subsource</span><span class="p">(</span><span class="n">agriculture_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">n_subsource</span><span class="p">(</span><span class="n">industry_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;n_subsource(industry_index)&#39;</span><span class="p">,</span><span class="n">n_subsource</span><span class="p">(</span><span class="n">industry_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">h_emis</span><span class="p">(</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;h_emis(traffic_index,1)&#39;</span><span class="p">,</span><span class="n">h_emis</span><span class="p">(</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">h_emis</span><span class="p">(</span><span class="n">shipping_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;h_emis(shipping_index,1)&#39;</span><span class="p">,</span><span class="n">h_emis</span><span class="p">(</span><span class="n">shipping_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">h_emis</span><span class="p">(</span><span class="n">heating_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;h_emis(heating_index,1)&#39;</span><span class="p">,</span><span class="n">h_emis</span><span class="p">(</span><span class="n">heating_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">h_emis</span><span class="p">(</span><span class="n">agriculture_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;h_emis(agriculture_index,1)&#39;</span><span class="p">,</span><span class="n">h_emis</span><span class="p">(</span><span class="n">agriculture_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">h_emis</span><span class="p">(</span><span class="n">industry_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;h_emis(industry_index,1)&#39;</span><span class="p">,</span><span class="n">h_emis</span><span class="p">(</span><span class="n">industry_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="c">!Additional GNFR sources</span>
<span class="w">            </span><span class="n">h_emis</span><span class="p">(</span><span class="n">publicpower_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;h_emis(publicpower_index,1)&#39;</span><span class="p">,</span><span class="n">h_emis</span><span class="p">(</span><span class="n">publicpower_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">h_emis</span><span class="p">(</span><span class="n">fugitive_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;h_emis(fugitive_index,1)&#39;</span><span class="p">,</span><span class="n">h_emis</span><span class="p">(</span><span class="n">fugitive_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">h_emis</span><span class="p">(</span><span class="n">solvents_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;h_emis(solvents_index,1)&#39;</span><span class="p">,</span><span class="n">h_emis</span><span class="p">(</span><span class="n">solvents_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">h_emis</span><span class="p">(</span><span class="n">aviation_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;h_emis(aviation_index,1)&#39;</span><span class="p">,</span><span class="n">h_emis</span><span class="p">(</span><span class="n">aviation_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">h_emis</span><span class="p">(</span><span class="n">offroad_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;h_emis(offroad_index,1)&#39;</span><span class="p">,</span><span class="n">h_emis</span><span class="p">(</span><span class="n">offroad_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">h_emis</span><span class="p">(</span><span class="n">waste_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;h_emis(waste_index,1)&#39;</span><span class="p">,</span><span class="n">h_emis</span><span class="p">(</span><span class="n">waste_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">h_emis</span><span class="p">(</span><span class="n">livestock_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;h_emis(livestock_index,1)&#39;</span><span class="p">,</span><span class="n">h_emis</span><span class="p">(</span><span class="n">livestock_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">h_emis</span><span class="p">(</span><span class="n">other_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;h_emis(other_index,1)&#39;</span><span class="p">,</span><span class="n">h_emis</span><span class="p">(</span><span class="n">other_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="c">!These second subsources do not exist but still possible to implement</span>
<span class="w">            </span><span class="n">h_emis</span><span class="p">(</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;h_emis(traffic_index,2)&#39;</span><span class="p">,</span><span class="n">h_emis</span><span class="p">(</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">h_emis</span><span class="p">(</span><span class="n">shipping_index</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;h_emis(shipping_index,2)&#39;</span><span class="p">,</span><span class="n">h_emis</span><span class="p">(</span><span class="n">shipping_index</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">h_emis</span><span class="p">(</span><span class="n">heating_index</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;h_emis(heating_index,2)&#39;</span><span class="p">,</span><span class="n">h_emis</span><span class="p">(</span><span class="n">heating_index</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">h_emis</span><span class="p">(</span><span class="n">agriculture_index</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;h_emis(agriculture_index,2)&#39;</span><span class="p">,</span><span class="n">h_emis</span><span class="p">(</span><span class="n">agriculture_index</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">h_emis</span><span class="p">(</span><span class="n">industry_index</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;h_emis(industry_index,2)&#39;</span><span class="p">,</span><span class="n">h_emis</span><span class="p">(</span><span class="n">industry_index</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_y_00(traffic_index,1)&#39;</span><span class="p">,</span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">shipping_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_y_00(shipping_index,1)&#39;</span><span class="p">,</span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">shipping_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">heating_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_y_00(heating_index,1)&#39;</span><span class="p">,</span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">heating_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">agriculture_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_y_00(agriculture_index,1)&#39;</span><span class="p">,</span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">agriculture_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">industry_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_y_00(industry_index,1)&#39;</span><span class="p">,</span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">industry_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="c">!Additional GNFR sources</span>
<span class="w">            </span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">publicpower_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_y_00(publicpower_index,1)&#39;</span><span class="p">,</span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">publicpower_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">fugitive_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_y_00(fugitive_index,1)&#39;</span><span class="p">,</span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">fugitive_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">solvents_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_y_00(solvents_index,1)&#39;</span><span class="p">,</span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">solvents_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">aviation_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_y_00(aviation_index,1)&#39;</span><span class="p">,</span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">aviation_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">offroad_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_y_00(offroad_index,1)&#39;</span><span class="p">,</span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">offroad_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">waste_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_y_00(waste_index,1)&#39;</span><span class="p">,</span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">waste_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">livestock_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_y_00(livestock_index,1)&#39;</span><span class="p">,</span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">livestock_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">other_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_y_00(other_index,1)&#39;</span><span class="p">,</span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">other_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="c">!These second subsources do not exist but still possible to implement</span>
<span class="w">            </span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_y_00(traffic_index,2)&#39;</span><span class="p">,</span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">shipping_index</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_y_00(shipping_index,2)&#39;</span><span class="p">,</span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">shipping_index</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">heating_index</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_y_00(heating_index,2)&#39;</span><span class="p">,</span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">heating_index</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">agriculture_index</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_y_00(agriculture_index,2)&#39;</span><span class="p">,</span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">agriculture_index</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">industry_index</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_y_00(industry_index,2)&#39;</span><span class="p">,</span><span class="n">sig_y_00</span><span class="p">(</span><span class="n">industry_index</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="c">!This scales the subgrid size to give to give sig_y_0. Optimal value is 0.8 so sig_y_0=0.8/2*delta_y</span>
<span class="w">            </span><span class="n">sigy_0_subgid_width_scale</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sigy_0_subgid_width_scale&#39;</span><span class="p">,</span><span class="n">sigy_0_subgid_width_scale</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_z_00(traffic_index,1)&#39;</span><span class="p">,</span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">shipping_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_z_00(shipping_index,1)&#39;</span><span class="p">,</span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">shipping_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">heating_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_z_00(heating_index,1)&#39;</span><span class="p">,</span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">heating_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">agriculture_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_z_00(agriculture_index,1)&#39;</span><span class="p">,</span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">agriculture_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">industry_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_z_00(industry_index,1)&#39;</span><span class="p">,</span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">industry_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="c">!Additional GNFR sources</span>
<span class="w">            </span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">publicpower_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_z_00(publicpower_index,1)&#39;</span><span class="p">,</span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">publicpower_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">fugitive_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_z_00(fugitive_index,1)&#39;</span><span class="p">,</span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">fugitive_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">solvents_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_z_00(solvents_index,1)&#39;</span><span class="p">,</span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">solvents_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">aviation_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_z_00(aviation_index,1)&#39;</span><span class="p">,</span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">aviation_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">offroad_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_z_00(offroad_index,1)&#39;</span><span class="p">,</span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">offroad_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">waste_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_z_00(waste_index,1)&#39;</span><span class="p">,</span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">waste_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">livestock_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_z_00(livestock_index,1)&#39;</span><span class="p">,</span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">livestock_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">other_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_z_00(other_index,1)&#39;</span><span class="p">,</span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">other_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="c">!These second subsources do not exist but still possible to implement</span>
<span class="w">            </span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_z_00(traffic_index,2)&#39;</span><span class="p">,</span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">shipping_index</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_z_00(shipping_index,2)&#39;</span><span class="p">,</span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">shipping_index</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">heating_index</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_z_00(heating_index,2)&#39;</span><span class="p">,</span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">heating_index</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">agriculture_index</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_z_00(agriculture_index,2)&#39;</span><span class="p">,</span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">agriculture_index</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">industry_index</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_z_00(industry_index,2)&#39;</span><span class="p">,</span><span class="n">sig_z_00</span><span class="p">(</span><span class="n">industry_index</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="c">!Read output grid path for all data</span>
<span class="w">            </span><span class="n">pathname_output_grid</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_output_grid&#39;</span><span class="p">,</span><span class="n">pathname_output_grid</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_date_output_grid</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_date_output_grid&#39;</span><span class="p">,</span><span class="n">filename_date_output_grid</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="c">!Read in file names. Only 2 choices for most file types</span>
<span class="w">            </span><span class="n">pathname_rl</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_rl(1)&#39;</span><span class="p">,</span><span class="n">pathname_rl</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">pathname_rl</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_rl(2)&#39;</span><span class="p">,</span><span class="n">pathname_rl</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_rl</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_rl(1)&#39;</span><span class="p">,</span><span class="n">filename_rl</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_rl</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_rl(2)&#39;</span><span class="p">,</span><span class="n">filename_rl</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">pathname_mrl</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_mrl(1)&#39;</span><span class="p">,</span><span class="n">pathname_mrl</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">pathname_mrl</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_mrl(2)&#39;</span><span class="p">,</span><span class="n">pathname_mrl</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">pathname_mrl</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_mrl(3)&#39;</span><span class="p">,</span><span class="n">pathname_mrl</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">pathname_mrl</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_mrl(4)&#39;</span><span class="p">,</span><span class="n">pathname_mrl</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">pathname_mrl</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_mrl(5)&#39;</span><span class="p">,</span><span class="n">pathname_mrl</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">pathname_mrl</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_mrl(6)&#39;</span><span class="p">,</span><span class="n">pathname_mrl</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">pathname_mrl</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_mrl(7)&#39;</span><span class="p">,</span><span class="n">pathname_mrl</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">pathname_mrl</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_mrl(8)&#39;</span><span class="p">,</span><span class="n">pathname_mrl</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">pathname_mrl</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_mrl(9)&#39;</span><span class="p">,</span><span class="n">pathname_mrl</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">pathname_mrl</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_mrl(10)&#39;</span><span class="p">,</span><span class="n">pathname_mrl</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_mrl</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_mrl(1)&#39;</span><span class="p">,</span><span class="n">filename_mrl</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_mrl</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_mrl(2)&#39;</span><span class="p">,</span><span class="n">filename_mrl</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_mrl</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_mrl(3)&#39;</span><span class="p">,</span><span class="n">filename_mrl</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_mrl</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_mrl(4)&#39;</span><span class="p">,</span><span class="n">filename_mrl</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_mrl</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_mrl(5)&#39;</span><span class="p">,</span><span class="n">filename_mrl</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_mrl</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_mrl(6)&#39;</span><span class="p">,</span><span class="n">filename_mrl</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_mrl</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_mrl(7)&#39;</span><span class="p">,</span><span class="n">filename_mrl</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_mrl</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_mrl(8)&#39;</span><span class="p">,</span><span class="n">filename_mrl</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_mrl</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_mrl(9)&#39;</span><span class="p">,</span><span class="n">filename_mrl</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_mrl</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_mrl(10)&#39;</span><span class="p">,</span><span class="n">filename_mrl</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">num_multiple_roadlink_files</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;num_multiple_roadlink_files&#39;</span><span class="p">,</span><span class="n">num_multiple_roadlink_files</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_EMEP(1)&#39;</span><span class="p">,</span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_EMEP(2)&#39;</span><span class="p">,</span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_EMEP(3)&#39;</span><span class="p">,</span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_EMEP(4)&#39;</span><span class="p">,</span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_EMEP(1)&#39;</span><span class="p">,</span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_EMEP(2)&#39;</span><span class="p">,</span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_EMEP(3)&#39;</span><span class="p">,</span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_EMEP(4)&#39;</span><span class="p">,</span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">original_pathname_EMEP</span><span class="o">=</span><span class="n">pathname_EMEP</span>
<span class="w">            </span><span class="n">original_filename_EMEP</span><span class="o">=</span><span class="n">filename_EMEP</span>


<span class="w">            </span><span class="n">pathname_ship</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_ship(1)&#39;</span><span class="p">,</span><span class="n">pathname_ship</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">pathname_ship</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_ship(2)&#39;</span><span class="p">,</span><span class="n">pathname_ship</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_ship</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_ship(1)&#39;</span><span class="p">,</span><span class="n">filename_ship</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_ship</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_ship(2)&#39;</span><span class="p">,</span><span class="n">filename_ship</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">pathname_agriculture</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_agriculture(1)&#39;</span><span class="p">,</span><span class="n">pathname_agriculture</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">pathname_agriculture</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_agriculture(2)&#39;</span><span class="p">,</span><span class="n">pathname_agriculture</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_agriculture</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_agriculture(1)&#39;</span><span class="p">,</span><span class="n">filename_agriculture</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_agriculture</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_agriculture(2)&#39;</span><span class="p">,</span><span class="n">filename_agriculture</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">pathname_emission_rivm</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_emission_rivm(1)&#39;</span><span class="p">,</span><span class="n">pathname_emission_rivm</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">pathname_emission_rivm</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_emission_rivm(2)&#39;</span><span class="p">,</span><span class="n">pathname_emission_rivm</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_emission_rivm</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_emission_rivm(1)&#39;</span><span class="p">,</span><span class="n">filename_emission_rivm</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_emission_rivm</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_emission_rivm(2)&#39;</span><span class="p">,</span><span class="n">filename_emission_rivm</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">pathname_industry</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_industry(1)&#39;</span><span class="p">,</span><span class="n">pathname_industry</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">pathname_industry</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_industry(2)&#39;</span><span class="p">,</span><span class="n">pathname_industry</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_industry</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_industry(1)&#39;</span><span class="p">,</span><span class="n">filename_industry</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_industry</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_industry(2)&#39;</span><span class="p">,</span><span class="n">filename_industry</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">pathname_heating</span><span class="p">(</span><span class="n">dwelling_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_heating(dwelling_index)&#39;</span><span class="p">,</span><span class="n">pathname_heating</span><span class="p">(</span><span class="n">dwelling_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">pathname_heating</span><span class="p">(</span><span class="n">population_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_heating(population_index)&#39;</span><span class="p">,</span><span class="n">pathname_heating</span><span class="p">(</span><span class="n">population_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_heating</span><span class="p">(</span><span class="n">dwelling_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_heating(dwelling_index)&#39;</span><span class="p">,</span><span class="n">filename_heating</span><span class="p">(</span><span class="n">dwelling_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_heating</span><span class="p">(</span><span class="n">population_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_heating(population_index)&#39;</span><span class="p">,</span><span class="n">filename_heating</span><span class="p">(</span><span class="n">population_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">pathname_heating</span><span class="p">(</span><span class="n">RWC_heating_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_heating(RWC_heating_index)&#39;</span><span class="p">,</span><span class="n">pathname_heating</span><span class="p">(</span><span class="n">RWC_heating_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_heating</span><span class="p">(</span><span class="n">RWC_heating_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_heating(RWC_heating_index)&#39;</span><span class="p">,</span><span class="n">filename_heating</span><span class="p">(</span><span class="n">RWC_heating_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">pathname_population</span><span class="p">(</span><span class="n">dwelling_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_population(dwelling_index)&#39;</span><span class="p">,</span><span class="n">pathname_population</span><span class="p">(</span><span class="n">dwelling_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">pathname_population</span><span class="p">(</span><span class="n">population_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_population(population_index)&#39;</span><span class="p">,</span><span class="n">pathname_population</span><span class="p">(</span><span class="n">population_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">pathname_population</span><span class="p">(</span><span class="n">establishment_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_population(establishment_index)&#39;</span><span class="p">,</span><span class="n">pathname_population</span><span class="p">(</span><span class="n">establishment_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">pathname_population</span><span class="p">(</span><span class="n">school_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_population(school_index)&#39;</span><span class="p">,</span><span class="n">pathname_population</span><span class="p">(</span><span class="n">school_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">pathname_population</span><span class="p">(</span><span class="n">kindergaten_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_population(kindergaten_index)&#39;</span><span class="p">,</span><span class="n">pathname_population</span><span class="p">(</span><span class="n">kindergaten_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">pathname_population</span><span class="p">(</span><span class="n">home_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_population(home_index)&#39;</span><span class="p">,</span><span class="n">pathname_population</span><span class="p">(</span><span class="n">home_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">pathname_population</span><span class="p">(</span><span class="n">municipality_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_population(municipality_index)&#39;</span><span class="p">,</span><span class="n">pathname_population</span><span class="p">(</span><span class="n">municipality_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_population</span><span class="p">(</span><span class="n">dwelling_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_population(dwelling_index)&#39;</span><span class="p">,</span><span class="n">filename_population</span><span class="p">(</span><span class="n">dwelling_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_population</span><span class="p">(</span><span class="n">population_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_population(population_index)&#39;</span><span class="p">,</span><span class="n">filename_population</span><span class="p">(</span><span class="n">population_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_population</span><span class="p">(</span><span class="n">establishment_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_population(establishment_index)&#39;</span><span class="p">,</span><span class="n">filename_population</span><span class="p">(</span><span class="n">establishment_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_population</span><span class="p">(</span><span class="n">school_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_population(school_index)&#39;</span><span class="p">,</span><span class="n">filename_population</span><span class="p">(</span><span class="n">school_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_population</span><span class="p">(</span><span class="n">kindergaten_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_population(kindergaten_index)&#39;</span><span class="p">,</span><span class="n">filename_population</span><span class="p">(</span><span class="n">kindergaten_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_population</span><span class="p">(</span><span class="n">home_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_population(home_index)&#39;</span><span class="p">,</span><span class="n">filename_population</span><span class="p">(</span><span class="n">home_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_population</span><span class="p">(</span><span class="n">municipality_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_population(municipality_index)&#39;</span><span class="p">,</span><span class="n">filename_population</span><span class="p">(</span><span class="n">municipality_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">pathname_receptor</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_receptor&#39;</span><span class="p">,</span><span class="n">pathname_receptor</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_receptor</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_receptor&#39;</span><span class="p">,</span><span class="n">filename_receptor</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">pathname_timeprofile</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_timeprofile&#39;</span><span class="p">,</span><span class="n">pathname_timeprofile</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_timeprofile</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_timeprofile&#39;</span><span class="p">,</span><span class="n">filename_timeprofile</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">population_data_type</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;population_data_type&#39;</span><span class="p">,</span><span class="n">population_data_type</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">FF_min_dispersion</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;FF_min_dispersion&#39;</span><span class="p">,</span><span class="n">FF_min_dispersion</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">emission_timeprofile_hour_shift</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;emission_timeprofile_hour_shift&#39;</span><span class="p">,</span><span class="n">emission_timeprofile_hour_shift</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">use_last_meteo_in_dispersion</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_last_meteo_in_dispersion&#39;</span><span class="p">,</span><span class="n">use_last_meteo_in_dispersion</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_meandering_in_dispersion</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_meandering_in_dispersion&#39;</span><span class="p">,</span><span class="n">use_meandering_in_dispersion</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">use_traffic_for_sigma0_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_traffic_for_sigma0_flag&#39;</span><span class="p">,</span><span class="n">use_traffic_for_sigma0_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="c">!use_traffic_for_minFF_flag=read_name_logical(&#39;use_traffic_for_minFF_flag&#39;,use_traffic_for_minFF_flag,unit_in,unit_logfile)</span>

<span class="w">            </span><span class="n">use_alternative_meteorology_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_alternative_meteorology_flag&#39;</span><span class="p">,</span><span class="n">use_alternative_meteorology_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">ustar_min</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;ustar_min&#39;</span><span class="p">,</span><span class="n">ustar_min</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">hmix_min</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;hmix_min&#39;</span><span class="p">,</span><span class="n">hmix_min</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">hmix_max</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;hmix_max&#39;</span><span class="p">,</span><span class="n">hmix_max</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_alternative_z0_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_alternative_z0_flag&#39;</span><span class="p">,</span><span class="n">use_alternative_z0_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">alternative_meteorology_type</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;alternative_meteorology_type&#39;</span><span class="p">,</span><span class="n">alternative_meteorology_type</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>


<span class="w">            </span><span class="c">!Read emission factors for traffic</span>
<span class="w">            </span><span class="n">emission_factor</span><span class="p">(</span><span class="n">nox_index</span><span class="p">,</span><span class="n">traffic_index</span><span class="p">,:)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;emission_factor(nox_index,traffic_index,:)&#39;</span><span class="p">,</span><span class="n">emission_factor</span><span class="p">(</span><span class="n">nox_index</span><span class="p">,</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">emission_factor</span><span class="p">(</span><span class="n">nox_index</span><span class="p">,</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;emission_factor(nox_index,traffic_index,1)&#39;</span><span class="p">,</span><span class="n">emission_factor</span><span class="p">(</span><span class="n">nox_index</span><span class="p">,</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">emission_factor</span><span class="p">(</span><span class="n">nox_index</span><span class="p">,</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;emission_factor(nox_index,traffic_index,2)&#39;</span><span class="p">,</span><span class="n">emission_factor</span><span class="p">(</span><span class="n">nox_index</span><span class="p">,</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">emission_factor</span><span class="p">(</span><span class="n">no2_index</span><span class="p">,</span><span class="n">traffic_index</span><span class="p">,:)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;emission_factor(no2_index,traffic_index,:)&#39;</span><span class="p">,</span><span class="n">emission_factor</span><span class="p">(</span><span class="n">no2_index</span><span class="p">,</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">emission_factor</span><span class="p">(</span><span class="n">no2_index</span><span class="p">,</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;emission_factor(no2_index,traffic_index,1)&#39;</span><span class="p">,</span><span class="n">emission_factor</span><span class="p">(</span><span class="n">no2_index</span><span class="p">,</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">emission_factor</span><span class="p">(</span><span class="n">no2_index</span><span class="p">,</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;emission_factor(no2_index,traffic_index,2)&#39;</span><span class="p">,</span><span class="n">emission_factor</span><span class="p">(</span><span class="n">no2_index</span><span class="p">,</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">emission_factor</span><span class="p">(</span><span class="n">pm25_index</span><span class="p">,</span><span class="n">traffic_index</span><span class="p">,:)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;emission_factor(pm25_index,traffic_index,:)&#39;</span><span class="p">,</span><span class="n">emission_factor</span><span class="p">(</span><span class="n">pm25_index</span><span class="p">,</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">emission_factor</span><span class="p">(</span><span class="n">pm25_index</span><span class="p">,</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;emission_factor(pm25_index,traffic_index,1)&#39;</span><span class="p">,</span><span class="n">emission_factor</span><span class="p">(</span><span class="n">pm25_index</span><span class="p">,</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">emission_factor</span><span class="p">(</span><span class="n">pm25_index</span><span class="p">,</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;emission_factor(pm25_index,traffic_index,2)&#39;</span><span class="p">,</span><span class="n">emission_factor</span><span class="p">(</span><span class="n">pm25_index</span><span class="p">,</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">emission_factor</span><span class="p">(</span><span class="n">pm10_index</span><span class="p">,</span><span class="n">traffic_index</span><span class="p">,:)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;emission_factor(pm10_index,traffic_index,:)&#39;</span><span class="p">,</span><span class="n">emission_factor</span><span class="p">(</span><span class="n">pm10_index</span><span class="p">,</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">emission_factor</span><span class="p">(</span><span class="n">pm10_index</span><span class="p">,</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;emission_factor(pm10_index,traffic_index,1)&#39;</span><span class="p">,</span><span class="n">emission_factor</span><span class="p">(</span><span class="n">pm10_index</span><span class="p">,</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">emission_factor</span><span class="p">(</span><span class="n">pm10_index</span><span class="p">,</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;emission_factor(pm10_index,traffic_index,2)&#39;</span><span class="p">,</span><span class="n">emission_factor</span><span class="p">(</span><span class="n">pm10_index</span><span class="p">,</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">emission_factor</span><span class="p">(</span><span class="n">pmex_index</span><span class="p">,</span><span class="n">traffic_index</span><span class="p">,:)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;emission_factor(pmex_index,traffic_index,:)&#39;</span><span class="p">,</span><span class="n">emission_factor</span><span class="p">(</span><span class="n">pmex_index</span><span class="p">,</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">emission_factor</span><span class="p">(</span><span class="n">pmex_index</span><span class="p">,</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;emission_factor(pmex_index,traffic_index,1)&#39;</span><span class="p">,</span><span class="n">emission_factor</span><span class="p">(</span><span class="n">pmex_index</span><span class="p">,</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">emission_factor</span><span class="p">(</span><span class="n">pmex_index</span><span class="p">,</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;emission_factor(pmex_index,traffic_index,2)&#39;</span><span class="p">,</span><span class="n">emission_factor</span><span class="p">(</span><span class="n">pmex_index</span><span class="p">,</span><span class="n">traffic_index</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">ratio_truck_car_emission</span><span class="p">(</span><span class="n">nox_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;ratio_truck_car_emission(nox_index)&#39;</span><span class="p">,</span><span class="n">ratio_truck_car_emission</span><span class="p">(</span><span class="n">nox_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">ratio_truck_car_emission</span><span class="p">(</span><span class="n">pm25_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;ratio_truck_car_emission(pm25_index)&#39;</span><span class="p">,</span><span class="n">ratio_truck_car_emission</span><span class="p">(</span><span class="n">pm25_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">ratio_truck_car_emission</span><span class="p">(</span><span class="n">pm10_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;ratio_truck_car_emission(pm10_index)&#39;</span><span class="p">,</span><span class="n">ratio_truck_car_emission</span><span class="p">(</span><span class="n">pm10_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="c">!NO2 ratio does not do anything but is included for possible future changes</span>
<span class="w">            </span><span class="n">ratio_truck_car_emission</span><span class="p">(</span><span class="n">no2_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;ratio_truck_car_emission(no2_index)&#39;</span><span class="p">,</span><span class="n">ratio_truck_car_emission</span><span class="p">(</span><span class="n">no2_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">z_rec</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;z_rec&#39;</span><span class="p">,</span><span class="n">z_rec</span><span class="p">(</span><span class="n">allsource_index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">replace_z0</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;replace_z0&#39;</span><span class="p">,</span><span class="n">replace_z0</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">replace_invL</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;replace_invL&#39;</span><span class="p">,</span><span class="n">replace_invL</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">replace_hmix</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;replace_hmix&#39;</span><span class="p">,</span><span class="n">replace_hmix</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">FF_scale</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;FF_scale&#39;</span><span class="p">,</span><span class="n">FF_scale</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">FF10_offset</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;FF10_offset&#39;</span><span class="p">,</span><span class="n">FF10_offset</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">DD_offset</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;DD_offset&#39;</span><span class="p">,</span><span class="n">DD_offset</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">J_scale</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;J_scale&#39;</span><span class="p">,</span><span class="n">J_scale</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">save_netcdf_file_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_netcdf_file_flag&#39;</span><span class="p">,</span><span class="n">save_netcdf_file_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_netcdf_receptor_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_netcdf_receptor_flag&#39;</span><span class="p">,</span><span class="n">save_netcdf_receptor_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_netcdf_fraction_as_contribution_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_netcdf_fraction_as_contribution_flag&#39;</span><span class="p">,</span><span class="n">save_netcdf_fraction_as_contribution_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">calculate_tiling_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_tiling_flag&#39;</span><span class="p">,</span><span class="n">calculate_tiling_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">calculate_region_tiling_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_region_tiling_flag&#39;</span><span class="p">,</span><span class="n">calculate_region_tiling_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">pathname_region_id</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_region_id&#39;</span><span class="p">,</span><span class="n">pathname_region_id</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_region_id</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_region_id&#39;</span><span class="p">,</span><span class="n">filename_region_id</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">region_name</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;region_name&#39;</span><span class="p">,</span><span class="n">region_name</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">region_id</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;region_id&#39;</span><span class="p">,</span><span class="n">region_id</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">region_index</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;region_index&#39;</span><span class="p">,</span><span class="n">region_index</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">region_subgrid_delta</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;region_subgrid_delta&#39;</span><span class="p">,</span><span class="n">region_subgrid_delta</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_region_select_and_mask_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_region_select_and_mask_flag&#39;</span><span class="p">,</span><span class="n">use_region_select_and_mask_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">max_interpolation_subgrid_size</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;max_interpolation_subgrid_size&#39;</span><span class="p">,</span><span class="n">max_interpolation_subgrid_size</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">pathname_tiles</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_tiles&#39;</span><span class="p">,</span><span class="n">pathname_tiles</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_tiles</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_tiles&#39;</span><span class="p">,</span><span class="n">filename_tiles</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">tile_tag</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;tile_tag&#39;</span><span class="p">,</span><span class="n">tile_tag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_tile_tag</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;save_tile_tag&#39;</span><span class="p">,</span><span class="n">save_tile_tag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">use_NORTRIP_emission_data</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_NORTRIP_emission_data&#39;</span><span class="p">,</span><span class="n">use_NORTRIP_emission_data</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_NORTRIP_emission_pollutant</span><span class="p">(</span><span class="n">nox_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_NORTRIP_emission_pollutant(nox_index)&#39;</span><span class="p">,</span><span class="n">use_NORTRIP_emission_pollutant</span><span class="p">(</span><span class="n">nox_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_NORTRIP_emission_pollutant</span><span class="p">(</span><span class="n">pm10_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_NORTRIP_emission_pollutant(pm10_index)&#39;</span><span class="p">,</span><span class="n">use_NORTRIP_emission_pollutant</span><span class="p">(</span><span class="n">pm10_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_NORTRIP_emission_pollutant</span><span class="p">(</span><span class="n">pm25_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_NORTRIP_emission_pollutant(pm25_index)&#39;</span><span class="p">,</span><span class="n">use_NORTRIP_emission_pollutant</span><span class="p">(</span><span class="n">pm25_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_NORTRIP_emission_pollutant</span><span class="p">(</span><span class="n">pmex_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_NORTRIP_emission_pollutant(pmex_index)&#39;</span><span class="p">,</span><span class="n">use_NORTRIP_emission_pollutant</span><span class="p">(</span><span class="n">pmex_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">use_RWC_emission_data</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_RWC_emission_data&#39;</span><span class="p">,</span><span class="n">use_RWC_emission_data</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">HDD_threshold_value</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;HDD_threshold_value&#39;</span><span class="p">,</span><span class="n">HDD_threshold_value</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">DMT_min_value</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;DMT_min_value&#39;</span><span class="p">,</span><span class="n">DMT_min_value</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">inpath_region_heating_scaling</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;inpath_region_heating_scaling&#39;</span><span class="p">,</span><span class="n">inpath_region_heating_scaling</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">infile_region_heating_scaling</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;infile_region_heating_scaling&#39;</span><span class="p">,</span><span class="n">infile_region_heating_scaling</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">integral_subgrid_delta_ref</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;integral_subgrid_delta_ref&#39;</span><span class="p">,</span><span class="n">integral_subgrid_delta_ref</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">pathname_rl_change</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_rl_change&#39;</span><span class="p">,</span><span class="n">pathname_rl_change</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_rl_change</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_rl_change&#39;</span><span class="p">,</span><span class="n">filename_rl_change</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">forecast_hour_str</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;forecast_hour_str&#39;</span><span class="p">,</span><span class="n">forecast_hour_str</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">NORTRIP_hour_str</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;NORTRIP_hour_str&#39;</span><span class="p">,</span><span class="n">NORTRIP_hour_str</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">include_o3_in_aqi_index</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;include_o3_in_aqi_index&#39;</span><span class="p">,</span><span class="n">include_o3_in_aqi_index</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">n_kz_iterations</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;n_kz_iterations&#39;</span><span class="p">,</span><span class="n">n_kz_iterations</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">read_weekly_shipping_data_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;read_weekly_shipping_data_flag&#39;</span><span class="p">,</span><span class="n">read_weekly_shipping_data_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">read_monthly_and_daily_shipping_data_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;read_monthly_and_daily_shipping_data_flag&#39;</span><span class="p">,</span><span class="n">read_monthly_and_daily_shipping_data_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">use_tunnel_emissions_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_tunnel_emissions_flag&#39;</span><span class="p">,</span><span class="n">use_tunnel_emissions_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_tunnel_deposition_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_tunnel_deposition_flag&#39;</span><span class="p">,</span><span class="n">use_tunnel_deposition_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">ventilation_factor</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;ventilation_factor&#39;</span><span class="p">,</span><span class="n">ventilation_factor</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">min_ADT_ventilation_factor</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;min_ADT_ventilation_factor&#39;</span><span class="p">,</span><span class="n">min_ADT_ventilation_factor</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">min_length_ventilation_factor</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;min_length_ventilation_factor&#39;</span><span class="p">,</span><span class="n">min_length_ventilation_factor</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">windspeed_tunnel</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;windspeed_tunnel&#39;</span><span class="p">,</span><span class="n">windspeed_tunnel</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>


<span class="w">            </span><span class="n">save_emissions_for_EMEP</span><span class="p">(</span><span class="n">traffic_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_emissions_for_EMEP(traffic_index)&#39;</span><span class="p">,</span><span class="n">save_emissions_for_EMEP</span><span class="p">(</span><span class="n">traffic_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_emissions_for_EMEP</span><span class="p">(</span><span class="n">shipping_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_emissions_for_EMEP(shipping_index)&#39;</span><span class="p">,</span><span class="n">save_emissions_for_EMEP</span><span class="p">(</span><span class="n">shipping_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_emissions_for_EMEP</span><span class="p">(</span><span class="n">industry_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_emissions_for_EMEP(industry_index)&#39;</span><span class="p">,</span><span class="n">save_emissions_for_EMEP</span><span class="p">(</span><span class="n">industry_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_emissions_for_EMEP</span><span class="p">(</span><span class="n">heating_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_emissions_for_EMEP(heating_index)&#39;</span><span class="p">,</span><span class="n">save_emissions_for_EMEP</span><span class="p">(</span><span class="n">heating_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_emissions_for_EMEP</span><span class="p">(</span><span class="n">agriculture_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_emissions_for_EMEP(agriculture_index)&#39;</span><span class="p">,</span><span class="n">save_emissions_for_EMEP</span><span class="p">(</span><span class="n">agriculture_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="c">!Additional GNFR sources</span>
<span class="w">            </span><span class="n">save_emissions_for_EMEP</span><span class="p">(</span><span class="n">publicpower_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_emissions_for_EMEP(publicpower_index)&#39;</span><span class="p">,</span><span class="n">save_emissions_for_EMEP</span><span class="p">(</span><span class="n">publicpower_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_emissions_for_EMEP</span><span class="p">(</span><span class="n">fugitive_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_emissions_for_EMEP(fugitive_index)&#39;</span><span class="p">,</span><span class="n">save_emissions_for_EMEP</span><span class="p">(</span><span class="n">fugitive_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_emissions_for_EMEP</span><span class="p">(</span><span class="n">solvents_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_emissions_for_EMEP(solvents_index)&#39;</span><span class="p">,</span><span class="n">save_emissions_for_EMEP</span><span class="p">(</span><span class="n">solvents_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_emissions_for_EMEP</span><span class="p">(</span><span class="n">aviation_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_emissions_for_EMEP(aviation_index)&#39;</span><span class="p">,</span><span class="n">save_emissions_for_EMEP</span><span class="p">(</span><span class="n">aviation_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_emissions_for_EMEP</span><span class="p">(</span><span class="n">offroad_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_emissions_for_EMEP(offroad_index)&#39;</span><span class="p">,</span><span class="n">save_emissions_for_EMEP</span><span class="p">(</span><span class="n">offroad_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_emissions_for_EMEP</span><span class="p">(</span><span class="n">waste_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_emissions_for_EMEP(waste_index)&#39;</span><span class="p">,</span><span class="n">save_emissions_for_EMEP</span><span class="p">(</span><span class="n">waste_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_emissions_for_EMEP</span><span class="p">(</span><span class="n">livestock_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_emissions_for_EMEP(livestock_index)&#39;</span><span class="p">,</span><span class="n">save_emissions_for_EMEP</span><span class="p">(</span><span class="n">livestock_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_emissions_for_EMEP</span><span class="p">(</span><span class="n">other_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_emissions_for_EMEP(other_index)&#39;</span><span class="p">,</span><span class="n">save_emissions_for_EMEP</span><span class="p">(</span><span class="n">other_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="c">!Set all source index to true if any of the sources are to be saved. allsource_index defines if the routine is called or not</span>
<span class="w">            </span><span class="k">do </span><span class="n">i_source</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n_source_index</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">save_emissions_for_EMEP</span><span class="p">(</span><span class="n">i_source</span><span class="p">))</span><span class="w"> </span><span class="n">save_emissions_for_EMEP</span><span class="p">(</span><span class="n">allsource_index</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">            </span><span class="k">enddo</span>

<span class="k">            </span><span class="n">pathname_emissions_for_EMEP</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_emissions_for_EMEP&#39;</span><span class="p">,</span><span class="n">pathname_emissions_for_EMEP</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">save_emissions_start_index</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;save_emissions_start_index&#39;</span><span class="p">,</span><span class="n">save_emissions_start_index</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_emissions_end_index</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;save_emissions_end_index&#39;</span><span class="p">,</span><span class="n">save_emissions_end_index</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">save_emissions_for_EMEP_projection</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;save_emissions_for_EMEP_projection&#39;</span><span class="p">,</span><span class="n">save_emissions_for_EMEP_projection</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_emissions_for_EMEP_region</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;save_emissions_for_EMEP_region&#39;</span><span class="p">,</span><span class="n">save_emissions_for_EMEP_region</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">save_compounds</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_compounds&#39;</span><span class="p">,</span><span class="n">save_compounds</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_source_contributions</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_source_contributions&#39;</span><span class="p">,</span><span class="n">save_source_contributions</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_emep_source_contributions</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_emep_source_contributions&#39;</span><span class="p">,</span><span class="n">save_emep_source_contributions</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_emep_additional_source_contributions</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_emep_additional_source_contributions&#39;</span><span class="p">,</span><span class="n">save_emep_additional_source_contributions</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_total_source_contributions</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_total_source_contributions&#39;</span><span class="p">,</span><span class="n">save_total_source_contributions</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_local_source_contributions_from_in_region</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_local_source_contributions_from_in_region&#39;</span><span class="p">,</span><span class="n">save_local_source_contributions_from_in_region</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_semilocal_source_contributions_from_in_region</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_semilocal_source_contributions_from_in_region&#39;</span><span class="p">,</span><span class="n">save_semilocal_source_contributions_from_in_region</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_total_source_contributions_from_in_region</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_total_source_contributions_from_in_region&#39;</span><span class="p">,</span><span class="n">save_total_source_contributions_from_in_region</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_no2_source_contributions</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_no2_source_contributions&#39;</span><span class="p">,</span><span class="n">save_no2_source_contributions</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_o3_source_contributions</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_o3_source_contributions&#39;</span><span class="p">,</span><span class="n">save_o3_source_contributions</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_wind_vectors</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_wind_vectors&#39;</span><span class="p">,</span><span class="n">save_wind_vectors</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_other_meteo</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_other_meteo&#39;</span><span class="p">,</span><span class="n">save_other_meteo</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_emep_original</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_emep_original&#39;</span><span class="p">,</span><span class="n">save_emep_original</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_emissions</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_emissions&#39;</span><span class="p">,</span><span class="n">save_emissions</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_for_chemistry</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_for_chemistry&#39;</span><span class="p">,</span><span class="n">save_for_chemistry</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_population</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_population&#39;</span><span class="p">,</span><span class="n">save_population</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_aqi</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_aqi&#39;</span><span class="p">,</span><span class="n">save_aqi</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_emep_species</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_emep_species&#39;</span><span class="p">,</span><span class="n">save_emep_species</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_deposition</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_deposition&#39;</span><span class="p">,</span><span class="n">save_deposition</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_seasalt</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_seasalt&#39;</span><span class="p">,</span><span class="n">save_seasalt</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">lowest_stable_L</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;lowest_stable_L&#39;</span><span class="p">,</span><span class="n">lowest_stable_L</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">lowest_unstable_L</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;lowest_unstable_L&#39;</span><span class="p">,</span><span class="n">lowest_unstable_L</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">tunnel_sig_z_00</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;tunnel_sig_z_00&#39;</span><span class="p">,</span><span class="n">tunnel_sig_z_00</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">bridge_h_emis</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;bridge_h_emis&#39;</span><span class="p">,</span><span class="n">bridge_h_emis</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="c">!Input variable names for meteo data read from EMEP</span>
<span class="w">            </span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">hmix_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;var_name_nc(hmix_nc_index)&#39;</span><span class="p">,</span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">hmix_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">u10_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;var_name_nc(u10_nc_index)&#39;</span><span class="p">,</span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">u10_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">v10_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;var_name_nc(v10_nc_index)&#39;</span><span class="p">,</span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">v10_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">FF10_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;var_name_nc(FF10_nc_index)&#39;</span><span class="p">,</span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">FF10_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">ugrid_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;var_name_nc(ugrid_nc_index)&#39;</span><span class="p">,</span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">ugrid_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">vgrid_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;var_name_nc(vgrid_nc_index)&#39;</span><span class="p">,</span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">vgrid_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">FFgrid_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;var_name_nc(FFgrid_nc_index)&#39;</span><span class="p">,</span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">FFgrid_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">inv_FFgrid_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;var_name_nc(inv_FFgrid_nc_index)&#39;</span><span class="p">,</span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">inv_FFgrid_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">inv_FF10_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;var_name_nc(inv_FF10_nc_index)&#39;</span><span class="p">,</span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">inv_FF10_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">kz_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;var_name_nc(kz_nc_index)&#39;</span><span class="p">,</span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">kz_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">ustar_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;var_name_nc(ustar_nc_index)&#39;</span><span class="p">,</span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">ustar_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">logz0_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;var_name_nc(logz0_nc_index)&#39;</span><span class="p">,</span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">logz0_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">invL_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;var_name_nc(invL_nc_index)&#39;</span><span class="p">,</span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">invL_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">ZTOP_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;var_name_nc(ZTOP_nc_index)&#39;</span><span class="p">,</span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">ZTOP_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">t2m_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;var_name_nc(t2m_nc_index)&#39;</span><span class="p">,</span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">t2m_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">precip_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;var_name_nc(precip_nc_index)&#39;</span><span class="p">,</span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">precip_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">J_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;var_name_nc(J_nc_index)&#39;</span><span class="p">,</span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">J_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">phi_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;var_name_nc(phi_nc_index)&#39;</span><span class="p">,</span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">phi_nc_index</span><span class="p">,</span><span class="n">all_nc_index</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">save_netcdf_average_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_netcdf_average_flag&#39;</span><span class="p">,</span><span class="n">save_netcdf_average_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">use_traffic_nox_emission_temperature_dependency</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_traffic_nox_emission_temperature_dependency&#39;</span><span class="p">,</span><span class="n">use_traffic_nox_emission_temperature_dependency</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">traffic_nox_emission_temperature_ref_temperature</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;traffic_nox_emission_temperature_ref_temperature(1)&#39;</span><span class="p">,</span><span class="n">traffic_nox_emission_temperature_ref_temperature</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">traffic_nox_emission_temperature_ref_temperature</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;traffic_nox_emission_temperature_ref_temperature(2)&#39;</span><span class="p">,</span><span class="n">traffic_nox_emission_temperature_ref_temperature</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">traffic_nox_emission_temperature_ref_scaling</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;traffic_nox_emission_temperature_ref_scaling(1)&#39;</span><span class="p">,</span><span class="n">traffic_nox_emission_temperature_ref_scaling</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">traffic_nox_emission_temperature_ref_scaling</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;traffic_nox_emission_temperature_ref_scaling(2)&#39;</span><span class="p">,</span><span class="n">traffic_nox_emission_temperature_ref_scaling</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">calculate_deposition_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_deposition_flag&#39;</span><span class="p">,</span><span class="n">calculate_deposition_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">calculate_source_depletion_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calculate_source_depletion_flag&#39;</span><span class="p">,</span><span class="n">calculate_source_depletion_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">read_landuse_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;read_landuse_flag&#39;</span><span class="p">,</span><span class="n">read_landuse_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_plume_dispersion_deposition_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_plume_dispersion_deposition_flag&#39;</span><span class="p">,</span><span class="n">use_plume_dispersion_deposition_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">pathname_landuse</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_landuse&#39;</span><span class="p">,</span><span class="n">pathname_landuse</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_landuse</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_landuse&#39;</span><span class="p">,</span><span class="n">filename_landuse</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">adjust_wetdepo_integral_to_lowest_layer_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;adjust_wetdepo_integral_to_lowest_layer_flag&#39;</span><span class="p">,</span><span class="n">adjust_wetdepo_integral_to_lowest_layer_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">auto_adjustment_for_summertime</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;auto_adjustment_for_summertime&#39;</span><span class="p">,</span><span class="n">auto_adjustment_for_summertime</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">use_EMEP_surface_ozone_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_EMEP_surface_ozone_flag&#39;</span><span class="p">,</span><span class="n">use_EMEP_surface_ozone_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_EMEP_surface_compounds_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_EMEP_surface_compounds_flag&#39;</span><span class="p">,</span><span class="n">use_EMEP_surface_compounds_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_water_in_EMEP_surface_pm_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_water_in_EMEP_surface_pm_flag&#39;</span><span class="p">,</span><span class="n">use_water_in_EMEP_surface_pm_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">save_compounds_as_ascii</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_compounds_as_ascii&#39;</span><span class="p">,</span><span class="n">save_compounds_as_ascii</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">use_GNFR_emissions_from_EMEP_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_GNFR_emissions_from_EMEP_flag&#39;</span><span class="p">,</span><span class="n">use_GNFR_emissions_from_EMEP_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_GNFR19_emissions_from_EMEP_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_GNFR19_emissions_from_EMEP_flag&#39;</span><span class="p">,</span><span class="n">use_GNFR19_emissions_from_EMEP_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_alphabetic_GNFR_emissions_from_EMEP_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_alphabetic_GNFR_emissions_from_EMEP_flag&#39;</span><span class="p">,</span><span class="n">use_alphabetic_GNFR_emissions_from_EMEP_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">use_emission_naming_template_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_emission_naming_template_flag&#39;</span><span class="p">,</span><span class="n">use_emission_naming_template_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">emission_naming_template_str</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;emission_naming_template_str&#39;</span><span class="p">,</span><span class="n">emission_naming_template_str</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">read_OSM_roadlink_data_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;read_OSM_roadlink_data_flag&#39;</span><span class="p">,</span><span class="n">read_OSM_roadlink_data_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">no_header_roadlink_data_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;no_header_roadlink_data_flag&#39;</span><span class="p">,</span><span class="n">no_header_roadlink_data_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">EMEP_surface_level_nc</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;EMEP_surface_level_nc&#39;</span><span class="p">,</span><span class="n">EMEP_surface_level_nc</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">EMEP_surface_level_nc_2</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;EMEP_surface_level_nc_2&#39;</span><span class="p">,</span><span class="n">EMEP_surface_level_nc_2</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">limit_industry_delta</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;limit_industry_delta&#39;</span><span class="p">,</span><span class="n">limit_industry_delta</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">limit_shipping_delta</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;limit_shipping_delta&#39;</span><span class="p">,</span><span class="n">limit_shipping_delta</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">limit_heating_delta</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;limit_heating_delta&#39;</span><span class="p">,</span><span class="n">limit_heating_delta</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">limit_population_delta</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;limit_population_delta&#39;</span><span class="p">,</span><span class="n">limit_population_delta</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">use_user_specified_sectors_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_user_specified_sectors_flag&#39;</span><span class="p">,</span><span class="n">use_user_specified_sectors_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">use_user_specified_sectors_flag</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                </span><span class="n">uEMEP_to_EMEP_replace_sector</span><span class="p">(</span><span class="n">traffic_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;uEMEP_to_EMEP_replace_sector(traffic_index)&#39;</span><span class="p">,</span><span class="n">uEMEP_to_EMEP_replace_sector</span><span class="p">(</span><span class="n">traffic_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">                </span><span class="n">uEMEP_to_EMEP_replace_sector</span><span class="p">(</span><span class="n">shipping_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;uEMEP_to_EMEP_replace_sector(shipping_index)&#39;</span><span class="p">,</span><span class="n">uEMEP_to_EMEP_replace_sector</span><span class="p">(</span><span class="n">shipping_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">                </span><span class="n">uEMEP_to_EMEP_replace_sector</span><span class="p">(</span><span class="n">agriculture_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;uEMEP_to_EMEP_replace_sector(agriculture_index)&#39;</span><span class="p">,</span><span class="n">uEMEP_to_EMEP_replace_sector</span><span class="p">(</span><span class="n">agriculture_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">                </span><span class="n">uEMEP_to_EMEP_replace_sector</span><span class="p">(</span><span class="n">heating_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;uEMEP_to_EMEP_replace_sector(heating_index)&#39;</span><span class="p">,</span><span class="n">uEMEP_to_EMEP_replace_sector</span><span class="p">(</span><span class="n">heating_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">                </span><span class="n">uEMEP_to_EMEP_replace_sector</span><span class="p">(</span><span class="n">industry_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;uEMEP_to_EMEP_replace_sector(industry_index)&#39;</span><span class="p">,</span><span class="n">uEMEP_to_EMEP_replace_sector</span><span class="p">(</span><span class="n">industry_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">                </span><span class="c">!Additional GNFR sources</span>
<span class="w">                </span><span class="n">uEMEP_to_EMEP_replace_sector</span><span class="p">(</span><span class="n">publicpower_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;uEMEP_to_EMEP_replace_sector(publicpower_index)&#39;</span><span class="p">,</span><span class="n">uEMEP_to_EMEP_replace_sector</span><span class="p">(</span><span class="n">publicpower_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">                </span><span class="n">uEMEP_to_EMEP_replace_sector</span><span class="p">(</span><span class="n">fugitive_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;uEMEP_to_EMEP_replace_sector(fugitive_index)&#39;</span><span class="p">,</span><span class="n">uEMEP_to_EMEP_replace_sector</span><span class="p">(</span><span class="n">fugitive_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">                </span><span class="n">uEMEP_to_EMEP_replace_sector</span><span class="p">(</span><span class="n">solvents_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;uEMEP_to_EMEP_replace_sector(solvents_index)&#39;</span><span class="p">,</span><span class="n">uEMEP_to_EMEP_replace_sector</span><span class="p">(</span><span class="n">solvents_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">                </span><span class="n">uEMEP_to_EMEP_replace_sector</span><span class="p">(</span><span class="n">aviation_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;uEMEP_to_EMEP_replace_sector(aviation_index)&#39;</span><span class="p">,</span><span class="n">uEMEP_to_EMEP_replace_sector</span><span class="p">(</span><span class="n">aviation_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">                </span><span class="n">uEMEP_to_EMEP_replace_sector</span><span class="p">(</span><span class="n">offroad_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;uEMEP_to_EMEP_replace_sector(offroad_index)&#39;</span><span class="p">,</span><span class="n">uEMEP_to_EMEP_replace_sector</span><span class="p">(</span><span class="n">offroad_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">                </span><span class="n">uEMEP_to_EMEP_replace_sector</span><span class="p">(</span><span class="n">waste_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;uEMEP_to_EMEP_replace_sector(waste_index)&#39;</span><span class="p">,</span><span class="n">uEMEP_to_EMEP_replace_sector</span><span class="p">(</span><span class="n">waste_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">                </span><span class="n">uEMEP_to_EMEP_replace_sector</span><span class="p">(</span><span class="n">livestock_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;uEMEP_to_EMEP_replace_sector(livestock_index)&#39;</span><span class="p">,</span><span class="n">uEMEP_to_EMEP_replace_sector</span><span class="p">(</span><span class="n">livestock_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">                </span><span class="n">uEMEP_to_EMEP_replace_sector</span><span class="p">(</span><span class="n">other_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;uEMEP_to_EMEP_replace_sector(other_index)&#39;</span><span class="p">,</span><span class="n">uEMEP_to_EMEP_replace_sector</span><span class="p">(</span><span class="n">other_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="k">endif</span>

<span class="k">            </span><span class="n">EMEP_emission_aggregation_period</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;EMEP_emission_aggregation_period&#39;</span><span class="p">,</span><span class="n">EMEP_emission_aggregation_period</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">read_population_from_netcdf_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;read_population_from_netcdf_flag&#39;</span><span class="p">,</span><span class="n">read_population_from_netcdf_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">read_population_from_netcdf_local_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;read_population_from_netcdf_local_flag&#39;</span><span class="p">,</span><span class="n">read_population_from_netcdf_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">auto_select_OSM_country_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;auto_select_OSM_country_flag&#39;</span><span class="p">,</span><span class="n">auto_select_OSM_country_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">pathname_boundingbox</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_boundingbox&#39;</span><span class="p">,</span><span class="n">pathname_boundingbox</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_boundingbox</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_boundingbox&#39;</span><span class="p">,</span><span class="n">filename_boundingbox</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">select_country_by_name</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;select_country_by_name&#39;</span><span class="p">,</span><span class="n">select_country_by_name</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">select_latlon_centre_domain_position_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;select_latlon_centre_domain_position_flag&#39;</span><span class="p">,</span><span class="n">select_latlon_centre_domain_position_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">select_lat_centre_position</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;select_lat_centre_position&#39;</span><span class="p">,</span><span class="n">select_lat_centre_position</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">select_lon_centre_position</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;select_lon_centre_position&#39;</span><span class="p">,</span><span class="n">select_lon_centre_position</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">select_domain_width_EW_km</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;select_domain_width_EW_km&#39;</span><span class="p">,</span><span class="n">select_domain_width_EW_km</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">select_domain_height_NS_km</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;select_domain_height_NS_km&#39;</span><span class="p">,</span><span class="n">select_domain_height_NS_km</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">osm_adt_power_scale</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;osm_adt_power_scale&#39;</span><span class="p">,</span><span class="n">osm_adt_power_scale</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">romberg_parameters</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;romberg_parameters(1)&#39;</span><span class="p">,</span><span class="n">romberg_parameters</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">romberg_parameters</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;romberg_parameters(2)&#39;</span><span class="p">,</span><span class="n">romberg_parameters</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">romberg_parameters</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;romberg_parameters(3)&#39;</span><span class="p">,</span><span class="n">romberg_parameters</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">SRM_parameters</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;SRM_parameters(1)&#39;</span><span class="p">,</span><span class="n">SRM_parameters</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span><span class="c">!beta</span>
<span class="w">            </span><span class="n">SRM_parameters</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;SRM_parameters(2)&#39;</span><span class="p">,</span><span class="n">SRM_parameters</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span><span class="c">!K</span>
<span class="w">            </span><span class="n">SRM_parameters</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;SRM_parameters(3)&#39;</span><span class="p">,</span><span class="n">SRM_parameters</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span><span class="c">!F</span>

<span class="w">            </span><span class="n">sig_y_scaling_factor</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;sig_y_scaling_factor&#39;</span><span class="p">,</span><span class="n">sig_y_scaling_factor</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">read_shipping_from_netcdf_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;read_shipping_from_netcdf_flag&#39;</span><span class="p">,</span><span class="n">read_shipping_from_netcdf_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">min_proxy_emission_shipping_value</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;min_proxy_emission_shipping_value&#39;</span><span class="p">,</span><span class="n">min_proxy_emission_shipping_value</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">population_power_scale</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;population_power_scale&#39;</span><span class="p">,</span><span class="n">population_power_scale</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">H_emep</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;H_emep&#39;</span><span class="p">,</span><span class="n">H_emep</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="c">!Allow the user to change the EMEP PM used for nonlocal contribution.</span>
<span class="w">            </span><span class="c">!Will be overridden by use_EMEP_surface_compounds_flag and use_water_in_EMEP_surface_pm_flag if they are set to true</span>
<span class="w">            </span><span class="n">comp_name_nc</span><span class="p">(</span><span class="n">pm10_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;comp_name_nc(pm10_nc_index)&#39;</span><span class="p">,</span><span class="n">comp_name_nc</span><span class="p">(</span><span class="n">pm10_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">comp_name_nc</span><span class="p">(</span><span class="n">pm25_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;comp_name_nc(pm25_nc_index)&#39;</span><span class="p">,</span><span class="n">comp_name_nc</span><span class="p">(</span><span class="n">pm25_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">comp_name_nc</span><span class="p">(</span><span class="n">o3_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;comp_name_nc(o3_nc_index)&#39;</span><span class="p">,</span><span class="n">comp_name_nc</span><span class="p">(</span><span class="n">o3_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">comp_name_nc</span><span class="p">(</span><span class="n">no2_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;comp_name_nc(no2_nc_index)&#39;</span><span class="p">,</span><span class="n">comp_name_nc</span><span class="p">(</span><span class="n">no2_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">comp_name_nc</span><span class="p">(</span><span class="n">nox_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;comp_name_nc(nox_nc_index)&#39;</span><span class="p">,</span><span class="n">comp_name_nc</span><span class="p">(</span><span class="n">nox_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">comp_name_nc</span><span class="p">(</span><span class="n">nh3_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;comp_name_nc(nh3_nc_index)&#39;</span><span class="p">,</span><span class="n">comp_name_nc</span><span class="p">(</span><span class="n">nh3_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">comp_name_nc</span><span class="p">(</span><span class="n">nh4_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;comp_name_nc(nh4_nc_index)&#39;</span><span class="p">,</span><span class="n">comp_name_nc</span><span class="p">(</span><span class="n">nh4_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">comp_name_nc</span><span class="p">(</span><span class="n">pmex_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;comp_name_nc(pmex_nc_index)&#39;</span><span class="p">,</span><span class="n">comp_name_nc</span><span class="p">(</span><span class="n">pmex_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">comp_name_nc</span><span class="p">(</span><span class="n">co_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;comp_name_nc(co_nc_index)&#39;</span><span class="p">,</span><span class="n">comp_name_nc</span><span class="p">(</span><span class="n">co_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">comp_name_nc</span><span class="p">(</span><span class="n">bap_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;comp_name_nc(bap_nc_index)&#39;</span><span class="p">,</span><span class="n">comp_name_nc</span><span class="p">(</span><span class="n">bap_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">comp_name_nc</span><span class="p">(</span><span class="n">c6h6_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;comp_name_nc(c6h6_nc_index)&#39;</span><span class="p">,</span><span class="n">comp_name_nc</span><span class="p">(</span><span class="n">c6h6_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">comp_name_nc</span><span class="p">(</span><span class="n">so2_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;comp_name_nc(so2_nc_index)&#39;</span><span class="p">,</span><span class="n">comp_name_nc</span><span class="p">(</span><span class="n">so2_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">comp_name_nc</span><span class="p">(</span><span class="n">somo35_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;comp_name_nc(somo35_nc_index)&#39;</span><span class="p">,</span><span class="n">comp_name_nc</span><span class="p">(</span><span class="n">somo35_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">comp_name_nc</span><span class="p">(</span><span class="n">comax_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;comp_name_nc(comax_nc_index)&#39;</span><span class="p">,</span><span class="n">comp_name_nc</span><span class="p">(</span><span class="n">comax_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">comp_name_nc</span><span class="p">(</span><span class="n">o3max_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;comp_name_nc(o3max_nc_index)&#39;</span><span class="p">,</span><span class="n">comp_name_nc</span><span class="p">(</span><span class="n">o3max_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">comp_name_nc</span><span class="p">(</span><span class="n">o3_26th_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;comp_name_nc(o3_26th_nc_index)&#39;</span><span class="p">,</span><span class="n">comp_name_nc</span><span class="p">(</span><span class="n">o3_26th_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">read_RWC_file_with_extra_HDD</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;read_RWC_file_with_extra_HDD&#39;</span><span class="p">,</span><span class="n">read_RWC_file_with_extra_HDD</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">read_RWC_file_with_extra_HDD_and_height</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;read_RWC_file_with_extra_HDD_and_height&#39;</span><span class="p">,</span><span class="n">read_RWC_file_with_extra_HDD_and_height</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="c">!Allows a scaling of EMEP input ozone. For testing.</span>
<span class="w">            </span><span class="n">comp_scale_nc</span><span class="p">(</span><span class="n">o3_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;comp_scale_nc(o3_nc_index)&#39;</span><span class="p">,</span><span class="n">comp_scale_nc</span><span class="p">(</span><span class="n">o3_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">comp_scale_nc</span><span class="p">(</span><span class="n">nox_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;comp_scale_nc(nox_nc_index)&#39;</span><span class="p">,</span><span class="n">comp_scale_nc</span><span class="p">(</span><span class="n">nox_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">comp_scale_nc</span><span class="p">(</span><span class="n">no2_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;comp_scale_nc(no2_nc_index)&#39;</span><span class="p">,</span><span class="n">comp_scale_nc</span><span class="p">(</span><span class="n">no2_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">use_alternative_traveltime_weighting</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_alternative_traveltime_weighting&#39;</span><span class="p">,</span><span class="n">use_alternative_traveltime_weighting</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">traveltime_power</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;traveltime_power&#39;</span><span class="p">,</span><span class="n">traveltime_power</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">traveltime_scaling</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;traveltime_scaling&#39;</span><span class="p">,</span><span class="n">traveltime_scaling</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_straightline_traveltime_distance</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_straightline_traveltime_distance&#39;</span><span class="p">,</span><span class="n">use_straightline_traveltime_distance</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="c">!Name of the netcdf variable read for population or dwelling proxy</span>
<span class="w">            </span><span class="n">var_name_population_nc</span><span class="p">(</span><span class="n">population_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;var_name_population_nc(population_nc_index)&#39;</span><span class="p">,</span><span class="n">var_name_population_nc</span><span class="p">(</span><span class="n">population_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">var_name_population_nc</span><span class="p">(</span><span class="n">dwelling_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;var_name_population_nc(dwelling_nc_index)&#39;</span><span class="p">,</span><span class="n">var_name_population_nc</span><span class="p">(</span><span class="n">dwelling_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">f_no2_emep</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;f_no2_emep&#39;</span><span class="p">,</span><span class="n">f_no2_emep</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">limit_emep_grid_interpolation_region_to_calculation_region</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;limit_emep_grid_interpolation_region_to_calculation_region&#39;</span><span class="p">,</span><span class="n">limit_emep_grid_interpolation_region_to_calculation_region</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">use_local_fraction_naming_template_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_local_fraction_naming_template_flag&#39;</span><span class="p">,</span><span class="n">use_local_fraction_naming_template_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_local_fraction_grid_size_in_template_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_local_fraction_grid_size_in_template_flag&#39;</span><span class="p">,</span><span class="n">use_local_fraction_grid_size_in_template_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">local_fraction_grid_size</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;local_fraction_grid_size(1)&#39;</span><span class="p">,</span><span class="n">local_fraction_grid_size</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">local_fraction_grid_size</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;local_fraction_grid_size(2)&#39;</span><span class="p">,</span><span class="n">local_fraction_grid_size</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">local_fraction_grid_size</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;local_fraction_grid_size(3)&#39;</span><span class="p">,</span><span class="n">local_fraction_grid_size</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">n_local_fraction_grids</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;n_local_fraction_grids&#39;</span><span class="p">,</span><span class="n">n_local_fraction_grids</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">local_fraction_naming_template_str</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;local_fraction_naming_template_str&#39;</span><span class="p">,</span><span class="n">local_fraction_naming_template_str</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">local_fraction_grid_for_EMEP_grid_interpolation</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;local_fraction_grid_for_EMEP_grid_interpolation&#39;</span><span class="p">,</span><span class="n">local_fraction_grid_for_EMEP_grid_interpolation</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">local_fraction_grid_for_EMEP_additional_grid_interpolation</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;local_fraction_grid_for_EMEP_additional_grid_interpolation&#39;</span><span class="p">,</span><span class="n">local_fraction_grid_for_EMEP_additional_grid_interpolation</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">save_traffic_emissions_for_EMEP_as_exhaust_nonexhaust_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_traffic_emissions_for_EMEP_as_exhaust_nonexhaust_flag&#39;</span><span class="p">,</span><span class="n">save_traffic_emissions_for_EMEP_as_exhaust_nonexhaust_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">n_var_av</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;n_var_av&#39;</span><span class="p">,</span><span class="n">n_var_av</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">finished_filename</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;finished_filename&#39;</span><span class="p">,</span><span class="n">finished_filename</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">finished_subpath</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;finished_subpath&#39;</span><span class="p">,</span><span class="n">finished_subpath</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">use_annual_mean_pdf_chemistry_correction</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_annual_mean_pdf_chemistry_correction&#39;</span><span class="p">,</span><span class="n">use_annual_mean_pdf_chemistry_correction</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">quick_annual_mean_pdf_chemistry_correction</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;quick_annual_mean_pdf_chemistry_correction&#39;</span><span class="p">,</span><span class="n">quick_annual_mean_pdf_chemistry_correction</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">ox_sigma_ratio_pdf</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;ox_sigma_ratio_pdf&#39;</span><span class="p">,</span><span class="n">ox_sigma_ratio_pdf</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">nox_sigma_ratio_pdf</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;nox_sigma_ratio_pdf&#39;</span><span class="p">,</span><span class="n">nox_sigma_ratio_pdf</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">min_bin_pdf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;min_bin_pdf&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">min_bin_pdf</span><span class="p">,</span><span class="w"> </span><span class="n">unit_in</span><span class="p">,</span><span class="w"> </span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">max_bin_pdf</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;max_bin_pdf&#39;</span><span class="p">,</span><span class="n">max_bin_pdf</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">log10_step_bin_pdf</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;log10_step_bin_pdf&#39;</span><span class="p">,</span><span class="n">log10_step_bin_pdf</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">use_landuse_as_proxy</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_landuse_as_proxy&#39;</span><span class="p">,</span><span class="n">use_landuse_as_proxy</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">read_rivm_landuse_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;read_rivm_landuse_flag&#39;</span><span class="p">,</span><span class="n">read_rivm_landuse_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">var_name_landuse_nc</span><span class="p">(</span><span class="n">num_var_landuse_nc</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;var_name_landuse_nc&#39;</span><span class="p">,</span><span class="n">var_name_landuse_nc</span><span class="p">(</span><span class="n">num_var_landuse_nc</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_rivm_agricuture_emission_data</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_rivm_agricuture_emission_data&#39;</span><span class="p">,</span><span class="n">use_rivm_agricuture_emission_data</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">read_subgrid_emission_data</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;read_subgrid_emission_data&#39;</span><span class="p">,</span><span class="n">read_subgrid_emission_data</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_rivm_subgrid_emission_format</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_rivm_subgrid_emission_format&#39;</span><span class="p">,</span><span class="n">use_rivm_subgrid_emission_format</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="c">!Read landuse weighting this may take some time</span>
<span class="w">            </span><span class="c">!Source input is numbered as GNFR13 in input but is placed in the uEMEP source sectors</span>
<span class="w">            </span><span class="k">do </span><span class="n">i_source</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n_source_index</span>
<span class="w">                </span><span class="k">do </span><span class="n">i_landuse</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n_clc_landuse_index</span>

<span class="w">                    </span><span class="k">write</span><span class="p">(</span><span class="n">UNIT</span><span class="o">=</span><span class="n">a_str</span><span class="p">,</span><span class="n">FMT</span><span class="o">=*</span><span class="p">)</span><span class="w"> </span><span class="n">convert_uEMEP_to_GNFR_sector_index</span><span class="p">(</span><span class="n">i_source</span><span class="p">)</span>
<span class="w">                    </span><span class="k">write</span><span class="p">(</span><span class="n">UNIT</span><span class="o">=</span><span class="n">b_str</span><span class="p">,</span><span class="n">FMT</span><span class="o">=*</span><span class="p">)</span><span class="w"> </span><span class="n">i_landuse</span>
<span class="w">                    </span><span class="n">temp_str</span><span class="o">=</span><span class="s1">&#39;landuse_proxy_weighting(&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">a_str</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">b_str</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;)&#39;</span>
<span class="w">                    </span><span class="c">!write(*,*) i_source,trim(temp_str)</span>
<span class="w">                    </span><span class="n">landuse_proxy_weighting</span><span class="p">(</span><span class="n">i_source</span><span class="p">,</span><span class="n">i_landuse</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">temp_str</span><span class="p">),</span><span class="n">landuse_proxy_weighting</span><span class="p">(</span><span class="n">i_source</span><span class="p">,</span><span class="n">i_landuse</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">                </span><span class="k">enddo</span>
<span class="k">            enddo</span>

<span class="w">            </span><span class="c">!Scale EMEP emission by sector</span>
<span class="w">            </span><span class="c">!Source input is numbered as GNFR13 in input but is placed in the uEMEP source sectors</span>
<span class="w">            </span><span class="k">do </span><span class="n">i_source</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n_source_index</span>

<span class="w">                </span><span class="k">write</span><span class="p">(</span><span class="n">UNIT</span><span class="o">=</span><span class="n">a_str</span><span class="p">,</span><span class="n">FMT</span><span class="o">=*</span><span class="p">)</span><span class="w"> </span><span class="n">convert_uEMEP_to_GNFR_sector_index</span><span class="p">(</span><span class="n">i_source</span><span class="p">)</span>
<span class="w">                </span><span class="n">temp_str</span><span class="o">=</span><span class="s1">&#39;scale_GNFR_emission_source(&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">a_str</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;)&#39;</span>
<span class="w">                </span><span class="c">!write(*,*) i_source,trim(temp_str)</span>
<span class="w">                </span><span class="n">scale_GNFR_emission_source</span><span class="p">(</span><span class="n">i_source</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">temp_str</span><span class="p">),</span><span class="n">scale_GNFR_emission_source</span><span class="p">(</span><span class="n">i_source</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="k">enddo</span>

<span class="w">            </span><span class="c">!Save original EMEP values for</span>
<span class="w">            </span><span class="n">save_EMEP_somo35</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_EMEP_somo35&#39;</span><span class="p">,</span><span class="n">save_EMEP_somo35</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_EMEP_comax</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_EMEP_comax&#39;</span><span class="p">,</span><span class="n">save_EMEP_comax</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_EMEP_o3max</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_EMEP_o3max&#39;</span><span class="p">,</span><span class="n">save_EMEP_o3max</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_EMEP_o3_26th</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_EMEP_o3_26th&#39;</span><span class="p">,</span><span class="n">save_EMEP_o3_26th</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_EMEP_so2</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_EMEP_so2&#39;</span><span class="p">,</span><span class="n">save_EMEP_so2</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="c">!Read subgrid receptor offset. This is for testing purposes only and applies only to the receptor subgrids</span>
<span class="w">            </span><span class="n">subgrid_receptor_offset</span><span class="p">(</span><span class="n">x_dim_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;subgrid_receptor_offset(x_dim_index)&#39;</span><span class="p">,</span><span class="n">subgrid_receptor_offset</span><span class="p">(</span><span class="n">x_dim_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">subgrid_receptor_offset</span><span class="p">(</span><span class="n">y_dim_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;subgrid_receptor_offset(y_dim_index)&#39;</span><span class="p">,</span><span class="n">subgrid_receptor_offset</span><span class="p">(</span><span class="n">y_dim_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">derive_SOA_from_other_species</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;derive_SOA_from_other_species&#39;</span><span class="p">,</span><span class="n">derive_SOA_from_other_species</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">Kz_scheme</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;Kz_scheme&#39;</span><span class="p">,</span><span class="n">Kz_scheme</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">use_phi_for_invL</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_phi_for_invL&#39;</span><span class="p">,</span><span class="n">use_phi_for_invL</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">z_invL</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;z_invL&#39;</span><span class="p">,</span><span class="n">z_invL</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">save_emission_subgrid_min</span><span class="p">(</span><span class="n">x_dim_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;save_emission_subgrid_min(x_dim_index)&#39;</span><span class="p">,</span><span class="n">save_emission_subgrid_min</span><span class="p">(</span><span class="n">x_dim_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_emission_subgrid_min</span><span class="p">(</span><span class="n">y_dim_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;save_emission_subgrid_min(y_dim_index)&#39;</span><span class="p">,</span><span class="n">save_emission_subgrid_min</span><span class="p">(</span><span class="n">y_dim_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_emission_subgrid_delta</span><span class="p">(</span><span class="n">x_dim_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;save_emission_subgrid_delta(x_dim_index)&#39;</span><span class="p">,</span><span class="n">save_emission_subgrid_delta</span><span class="p">(</span><span class="n">x_dim_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_emission_subgrid_delta</span><span class="p">(</span><span class="n">y_dim_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_real</span><span class="p">(</span><span class="s1">&#39;save_emission_subgrid_delta(y_dim_index)&#39;</span><span class="p">,</span><span class="n">save_emission_subgrid_delta</span><span class="p">(</span><span class="n">y_dim_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_emission_subgrid_dim</span><span class="p">(</span><span class="n">x_dim_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;save_emission_subgrid_dim(x_dim_index)&#39;</span><span class="p">,</span><span class="n">save_emission_subgrid_dim</span><span class="p">(</span><span class="n">x_dim_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">save_emission_subgrid_dim</span><span class="p">(</span><span class="n">y_dim_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;save_emission_subgrid_dim(y_dim_index)&#39;</span><span class="p">,</span><span class="n">save_emission_subgrid_dim</span><span class="p">(</span><span class="n">y_dim_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">trace_emissions_from_in_region</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;trace_emissions_from_in_region&#39;</span><span class="p">,</span><span class="n">trace_emissions_from_in_region</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">calc_grid_vertical_average_concentration_annual_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;calc_grid_vertical_average_concentration_annual_flag&#39;</span><span class="p">,</span><span class="n">calc_grid_vertical_average_concentration_annual_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">wind_level_zc_flag</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;wind_level_zc_flag&#39;</span><span class="p">,</span><span class="n">wind_level_zc_flag</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">use_alternative_ppm_variable_for_lf</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;use_alternative_ppm_variable_for_lf&#39;</span><span class="p">,</span><span class="n">use_alternative_ppm_variable_for_lf</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">alternative_ppm_variable_for_lf_dim</span><span class="o">=</span><span class="n">read_name_integer</span><span class="p">(</span><span class="s1">&#39;alternative_ppm_variable_for_lf_dim&#39;</span><span class="p">,</span><span class="n">alternative_ppm_variable_for_lf_dim</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">conc_nc_index</span><span class="p">,</span><span class="n">pm25_nc_index</span><span class="p">,</span><span class="n">extrasource_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;var_name_nc(conc_nc_index,pm25_nc_index,extrasource_nc_index)&#39;</span><span class="p">,</span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">conc_nc_index</span><span class="p">,</span><span class="n">pm25_nc_index</span><span class="p">,</span><span class="n">extrasource_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">conc_nc_index</span><span class="p">,</span><span class="n">pmco_nc_index</span><span class="p">,</span><span class="n">extrasource_nc_index</span><span class="p">)</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;var_name_nc(conc_nc_index,pmco_nc_index,extrasource_nc_index)&#39;</span><span class="p">,</span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">conc_nc_index</span><span class="p">,</span><span class="n">pmco_nc_index</span><span class="p">,</span><span class="n">extrasource_nc_index</span><span class="p">),</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="n">save_emep_OP_species</span><span class="o">=</span><span class="n">read_name_logical</span><span class="p">(</span><span class="s1">&#39;save_emep_OP_species&#39;</span><span class="p">,</span><span class="n">save_emep_OP_species</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Read configs added for the nonlocal from-in-region method</span>
<span class="w">            </span><span class="n">pathname_region_mask</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;pathname_region_mask&#39;</span><span class="p">,</span><span class="n">pathname_region_mask</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_region_mask</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;filename_region_mask&#39;</span><span class="p">,</span><span class="n">filename_region_mask</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>
<span class="w">            </span><span class="n">varname_region_mask</span><span class="o">=</span><span class="n">read_name_char</span><span class="p">(</span><span class="s1">&#39;varname_region_mask&#39;</span><span class="p">,</span><span class="n">varname_region_mask</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_logfile</span><span class="p">)</span>

<span class="w">            </span><span class="k">close</span><span class="w"> </span><span class="p">(</span><span class="n">unit_in</span><span class="p">)</span>

<span class="w">        </span><span class="k">enddo</span><span class="w"> </span><span class="c">!End configuration file number loop</span>

<span class="w">        </span><span class="c">!The rest below was inside the file loop before. Have moved to outside now. Hope that works!</span>

<span class="w">        </span><span class="c">!Call some error traps</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">pathname_output_grid</span><span class="p">)).</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            write</span><span class="w"> </span><span class="p">(</span><span class="n">unit_logfile</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;WARNING: No output path given in configuration file. Stopping&#39;</span>
<span class="w">            </span><span class="k">stop</span>
<span class="k">        endif</span>
<span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="n">local_subgrid_method_flag</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">trace_emissions_from_in_region</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            write</span><span class="p">(</span><span class="n">unit_logfile</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;trace_emissions_from_in_region must be false when local_subgrid_method_flag is 1, since it is not possible to trace emission origin when EMEP concentrations are directly redistributed. Stopping&#39;</span>
<span class="w">            </span><span class="k">stop</span>
<span class="k">        end if</span>

<span class="w">        </span><span class="c">!Find the correct compound index based on the compound string</span>
<span class="w">        </span><span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n_pollutant_nc_index</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">var_name_nc</span><span class="p">(</span><span class="n">conc_nc_index</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">allsource_nc_index</span><span class="p">)).</span><span class="n">eq</span><span class="p">.</span><span class="nb">trim</span><span class="p">(</span><span class="n">input_comp_name</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                </span><span class="n">compound_index</span><span class="o">=</span><span class="n">i</span>
<span class="w">                </span><span class="n">pollutant_index</span><span class="o">=</span><span class="n">i</span>
<span class="w">                </span><span class="k">write</span><span class="p">(</span><span class="n">unit_logfile</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Selected pollutant: &#39;</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">input_comp_name</span><span class="p">),</span><span class="n">i</span>
<span class="w">            </span><span class="k">endif</span>
<span class="k">        enddo</span>


<span class="w">        </span><span class="c">!Replace some of the strings with the date_str. Do this twice in case there are two occurences of it in a string</span>
<span class="w">        </span><span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<span class="w">            </span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">config_date_str</span><span class="p">,</span><span class="n">replacement_date_str</span><span class="p">,</span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="w">            </span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">config_date_str</span><span class="p">,</span><span class="n">replacement_date_str</span><span class="p">,</span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="w">            </span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">config_date_str</span><span class="p">,</span><span class="n">replacement_date_str</span><span class="p">,</span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="w">            </span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">config_date_str</span><span class="p">,</span><span class="n">replacement_date_str</span><span class="p">,</span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="w">            </span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">config_date_str</span><span class="p">,</span><span class="n">replacement_date_str</span><span class="p">,</span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="w">            </span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">config_date_str</span><span class="p">,</span><span class="n">replacement_date_str</span><span class="p">,</span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="w">            </span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">config_date_str</span><span class="p">,</span><span class="n">replacement_date_str</span><span class="p">,</span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="w">            </span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">config_date_str</span><span class="p">,</span><span class="n">replacement_date_str</span><span class="p">,</span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="w">            </span><span class="n">pathname_output_grid</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">config_date_str</span><span class="p">,</span><span class="n">replacement_date_str</span><span class="p">,</span><span class="n">pathname_output_grid</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_date_output_grid</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">config_date_str</span><span class="p">,</span><span class="n">replacement_date_str</span><span class="p">,</span><span class="n">filename_date_output_grid</span><span class="p">)</span>
<span class="w">            </span><span class="c">!NORTRIP file and path name</span>
<span class="w">            </span><span class="n">pathname_rl</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">config_date_str</span><span class="p">,</span><span class="n">replacement_date_str</span><span class="p">,</span><span class="n">pathname_rl</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="w">            </span><span class="n">filename_rl</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">config_date_str</span><span class="p">,</span><span class="n">replacement_date_str</span><span class="p">,</span><span class="n">filename_rl</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

<span class="w">            </span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">forecast_hour_str</span><span class="p">,</span><span class="n">replacement_hour_str</span><span class="p">,</span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="w">            </span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">forecast_hour_str</span><span class="p">,</span><span class="n">replacement_hour_str</span><span class="p">,</span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="w">            </span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">forecast_hour_str</span><span class="p">,</span><span class="n">replacement_hour_str</span><span class="p">,</span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="w">            </span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">forecast_hour_str</span><span class="p">,</span><span class="n">replacement_hour_str</span><span class="p">,</span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="w">            </span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">forecast_hour_str</span><span class="p">,</span><span class="n">replacement_hour_str</span><span class="p">,</span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="w">            </span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">forecast_hour_str</span><span class="p">,</span><span class="n">replacement_hour_str</span><span class="p">,</span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="w">            </span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">forecast_hour_str</span><span class="p">,</span><span class="n">replacement_hour_str</span><span class="p">,</span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="w">            </span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">forecast_hour_str</span><span class="p">,</span><span class="n">replacement_hour_str</span><span class="p">,</span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="w">            </span><span class="n">pathname_output_grid</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">forecast_hour_str</span><span class="p">,</span><span class="n">replacement_hour_str</span><span class="p">,</span><span class="n">pathname_output_grid</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_date_output_grid</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">forecast_hour_str</span><span class="p">,</span><span class="n">replacement_hour_str</span><span class="p">,</span><span class="n">filename_date_output_grid</span><span class="p">)</span>
<span class="w">            </span><span class="c">!NORTRIP file and path name</span>
<span class="w">            </span><span class="n">pathname_rl</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">NORTRIP_hour_str</span><span class="p">,</span><span class="n">NORTRIP_replacement_hour_str</span><span class="p">,</span><span class="n">pathname_rl</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="w">            </span><span class="n">filename_rl</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">NORTRIP_hour_str</span><span class="p">,</span><span class="n">NORTRIP_replacement_hour_str</span><span class="p">,</span><span class="n">filename_rl</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

<span class="w">        </span><span class="k">enddo</span>

<span class="w">        </span><span class="c">!Replace date in the output file if required, 3 times for yyyy mm dd</span>
<span class="w">        </span><span class="n">format_temp</span><span class="o">=</span><span class="s1">&#39;yyyymmdd&#39;</span>
<span class="w">        </span><span class="k">call </span><span class="n">datestr_to_date</span><span class="p">(</span><span class="n">config_date_str</span><span class="p">,</span><span class="n">format_temp</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
<span class="w">        </span><span class="c">!write (unit_logfile,&#39;(2A)&#39;) &#39; Updating output path from: &#39;,trim(pathname_output_grid)</span>

<span class="w">        </span><span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
<span class="w">            </span><span class="k">call </span><span class="n">date_to_datestr_bracket</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">pathname_output_grid</span><span class="p">,</span><span class="n">pathname_output_grid</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">date_to_datestr_bracket</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">filename_date_output_grid</span><span class="p">,</span><span class="n">filename_date_output_grid</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">date_to_datestr_bracket</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="w">            </span><span class="k">call </span><span class="n">date_to_datestr_bracket</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="w">            </span><span class="k">call </span><span class="n">date_to_datestr_bracket</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="w">            </span><span class="k">call </span><span class="n">date_to_datestr_bracket</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="w">            </span><span class="k">call </span><span class="n">date_to_datestr_bracket</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">pathname_rl</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">pathname_rl</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="w">            </span><span class="k">call </span><span class="n">date_to_datestr_bracket</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">pathname_rl</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">pathname_rl</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

<span class="w">            </span><span class="k">call </span><span class="n">date_to_datestr_bracket</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="w">            </span><span class="k">call </span><span class="n">date_to_datestr_bracket</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="w">            </span><span class="k">call </span><span class="n">date_to_datestr_bracket</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="w">            </span><span class="k">call </span><span class="n">date_to_datestr_bracket</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="w">            </span><span class="k">call </span><span class="n">date_to_datestr_bracket</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">filename_rl</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">filename_rl</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="w">            </span><span class="k">call </span><span class="n">date_to_datestr_bracket</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">filename_rl</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">filename_rl</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

<span class="w">            </span><span class="k">call </span><span class="n">date_to_datestr_bracket</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">pathname_emissions_for_EMEP</span><span class="p">,</span><span class="n">pathname_emissions_for_EMEP</span><span class="p">)</span>

<span class="w">        </span><span class="k">enddo</span>
<span class="w">        </span><span class="c">!write (unit_logfile,&#39;(2A)&#39;) &#39; Updating output path to:   &#39;,trim(pathname_output_grid)</span>
<span class="w">        </span><span class="c">!write (unit_logfile,&#39;(2A)&#39;) &#39; Updating output file to:   &#39;,trim(pathname_EMEP(1))</span>

<span class="w">        </span><span class="c">!Specify the yesterday date string and replace it if found. Identified wiht a square bracket</span>
<span class="w">        </span><span class="c">!call datestr_to_date(config_date_str,format_temp,a)</span>
<span class="w">        </span><span class="n">datenum_temp</span><span class="o">=</span><span class="n">date_to_number</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">ref_year_EMEP</span><span class="p">)</span>
<span class="w">        </span><span class="n">datenum_temp</span><span class="o">=</span><span class="n">datenum_temp</span><span class="o">-</span><span class="mf">1.</span>
<span class="w">        </span><span class="k">call </span><span class="n">number_to_date</span><span class="p">(</span><span class="n">datenum_temp</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">ref_year_EMEP</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">date_to_datestr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">format_temp</span><span class="p">,</span><span class="n">yesterday_date_str</span><span class="p">)</span>
<span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="n">unit_logfile</span><span class="p">,</span><span class="s1">&#39;(2a)&#39;</span><span class="p">)</span><span class="s1">&#39;Todays date string: &#39;</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">config_date_str</span><span class="p">)</span>
<span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="n">unit_logfile</span><span class="p">,</span><span class="s1">&#39;(2a)&#39;</span><span class="p">)</span><span class="s1">&#39;Yesterdays date string: &#39;</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">yesterday_date_str</span><span class="p">)</span>

<span class="w">        </span><span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
<span class="w">            </span><span class="k">call </span><span class="n">date_to_datestr_squarebracket</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">pathname_output_grid</span><span class="p">,</span><span class="n">pathname_output_grid</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">date_to_datestr_squarebracket</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">filename_date_output_grid</span><span class="p">,</span><span class="n">filename_date_output_grid</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">date_to_datestr_squarebracket</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="w">            </span><span class="k">call </span><span class="n">date_to_datestr_squarebracket</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="w">            </span><span class="k">call </span><span class="n">date_to_datestr_squarebracket</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="w">            </span><span class="k">call </span><span class="n">date_to_datestr_squarebracket</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="w">            </span><span class="k">call </span><span class="n">date_to_datestr_squarebracket</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">pathname_rl</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">pathname_rl</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="w">            </span><span class="k">call </span><span class="n">date_to_datestr_squarebracket</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">pathname_rl</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">pathname_rl</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="w">        </span><span class="k">enddo</span>

<span class="k">        do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<span class="w">            </span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">yesterday_date_str</span><span class="p">,</span><span class="n">replacement_yesterday_date_str</span><span class="p">,</span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="w">            </span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">yesterday_date_str</span><span class="p">,</span><span class="n">replacement_yesterday_date_str</span><span class="p">,</span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="w">            </span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">yesterday_date_str</span><span class="p">,</span><span class="n">replacement_yesterday_date_str</span><span class="p">,</span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="w">            </span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">yesterday_date_str</span><span class="p">,</span><span class="n">replacement_yesterday_date_str</span><span class="p">,</span><span class="n">pathname_EMEP</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="w">            </span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">yesterday_date_str</span><span class="p">,</span><span class="n">replacement_yesterday_date_str</span><span class="p">,</span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="w">            </span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">yesterday_date_str</span><span class="p">,</span><span class="n">replacement_yesterday_date_str</span><span class="p">,</span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="w">            </span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">yesterday_date_str</span><span class="p">,</span><span class="n">replacement_yesterday_date_str</span><span class="p">,</span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="w">            </span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">yesterday_date_str</span><span class="p">,</span><span class="n">replacement_yesterday_date_str</span><span class="p">,</span><span class="n">filename_EMEP</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="w">            </span><span class="n">pathname_output_grid</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">yesterday_date_str</span><span class="p">,</span><span class="n">replacement_yesterday_date_str</span><span class="p">,</span><span class="n">pathname_output_grid</span><span class="p">)</span>
<span class="w">            </span><span class="n">filename_date_output_grid</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">yesterday_date_str</span><span class="p">,</span><span class="n">replacement_yesterday_date_str</span><span class="p">,</span><span class="n">filename_date_output_grid</span><span class="p">)</span>
<span class="w">            </span><span class="c">!NORTRIP file and path name</span>
<span class="w">            </span><span class="n">pathname_rl</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">yesterday_date_str</span><span class="p">,</span><span class="n">replacement_yesterday_date_str</span><span class="p">,</span><span class="n">pathname_rl</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="w">            </span><span class="n">filename_rl</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">replace_string_char</span><span class="p">(</span><span class="n">yesterday_date_str</span><span class="p">,</span><span class="n">replacement_yesterday_date_str</span><span class="p">,</span><span class="n">filename_rl</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="w">        </span><span class="k">enddo</span>

<span class="w">        </span><span class="c">!write(*,*) trim(filename_EMEP(3))</span>
<span class="w">        </span><span class="c">!write(*,*) trim(pathname_EMEP(3))</span>


<span class="w">        </span><span class="c">!Place tile_tag in front of file_tag if it has been read</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tile_tag</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">file_tag</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">file_tag</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">tile_tag</span><span class="p">)</span>
<span class="w">        </span><span class="k">endif</span>

<span class="k">    end subroutine </span><span class="n">uEMEP_read_config</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              Fortran Program
              &copy; 2024 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>    

    <!-- MathJax JavaScript
             ================================================== -->
             <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
          jax: ['input/TeX','input/MathML','output/HTML-CSS'],
          extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
          });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

          <script src="../tipuesearch/tipuesearch_content.js"></script>
          <script src="../tipuesearch/tipuesearch_set.js"></script>
          <script src="../tipuesearch/tipuesearch.js"></script>

  </body>
</html>